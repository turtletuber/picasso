{"version":3,"sources":["config/firebase.js","Login/SignIn.js","Textbook/Components/Navbar/svg/logo.svg","Textbook/Components/Navbar/svg/bookmark_border.svg","Textbook/Components/Navbar/svg/note_add.svg","Textbook/Components/Navbar/svg/search.svg","Textbook/Components/Navbar/svg/volume_up.svg","utils/refresh.js","Textbook/Components/Navbar/Controls.js","Textbook/Components/Navbar/Account/AccountInformation.js","Textbook/Components/Navbar/NavBar.js","Textbook/Components/SideBar/svg/bookmark_border.svg","Textbook/Components/SideBar/SideBar.js","Textbook/Components/Chapter/Question/ResponseQuestion.js","Textbook/Components/Chapter/Question/TrueFalseQuestion.js","Textbook/Components/Chapter/Question/MultipleChoiceQuestion.js","Textbook/Components/Chapter/Chapter.js","Textbook/TextBookViewer.js","Auth.js","PrivateRoute.js","AddBook/AddBookScreen.js","Home/svg/Logo.svg","Home/svg/Hero.svg","Home/home.js","index.js","utils/BookHTMLToJSONBuilder.js"],"names":["require","firebase","apps","length","app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","analytics","f_db","firestore","f_auth","auth","f_storage_ref","storage","ref","uiConfig","signInFlow","signInSuccessUrl","signInOptions","EmailAuthProvider","PROVIDER_ID","SignInScreen","firebaseAuth","bring_it_in","docId","console","log","url","fetch","then","response","text","contents","html","docID","json","BookHTMLToJSON","newBookRef","child","jsonString","JSON","stringify","blob","Blob","type","put","snapshot","window","location","reload","upload","conversion","catch","refresh","URL","href","hash","split","Controls","className","IconButton","color","aria-label","component","src","Audio","alt","onClick","e","preventDefault","BookMark","AddNote","Search","Component","AccountInformation","handleClickOutside","evt","props","outsideClickHandler","logout","signOut","this","show","style","minWidth","position","top","right","margin","Card","Typography","variant","align","marginTop","currentUser","displayName","Divider","List","ListItem","button","import","to","display","textDecoration","ListItemIcon","ListItemText","primary","onClickOutside","NavBar","preventDragHandler","avatarClicked","setState","showAccountInformation","state","clickedOutsideHandler","target","id","name","onDragStart","Logo","height","Avatar","charAt","toUpperCase","SideBar","chapterList","book","chapters","SideBarElementList","StyledButton","withStyles","root","borderRadius","fontSize","fontWeight","padding","borderBottomRightRadius","borderTopRightRadius","label","textTransform","Button","entries","index","chapter","push","handler","SideBarElement","isBookmarked","isSelected","currentSelectedChapter","flexDirection","trim","width","paddingLeft","paddingRight","alignItems","backgroundColor","HtmlTooltip","theme","tooltip","typography","pxToRem","Tooltip","chipStyle","marginRight","title","arrow","placement","Chip","size","overflow","textOverflow","whiteSpace","ResponseQuestion","saveResponse","saveToFirebase","hasResponded","onEdit","oldResponse","onChangeResponse","value","loadFirebaseResponse","query","collection","where","uid","parseInt","chapterNumber","questionNumber","bookID","referenceToOldThis","get","querySnapshot","forEach","doc","data","dirty","error","responseAlreadyExists","update","add","studentID","docRef","cancelEdit","needsFirebaseLoading","questionText","responseQuestion","Box","boxShadow","TextField","marginBottom","multiline","onChange","defaultValue","float","visibility","responseQuestionRespondedView","TrueFalseQuestion","question","correctAnswer","borderWidth","horizontal","rootColor","pointColor","MultipleChoiceQuestion","choicesArray","slice","items","vertical","map","item","currentChapter","HashMap","newQuestionId","contains","node","tag","undefined","children","i","transform","startsWith","getText","String","attribs","convertNodeToElement","justifyContent","urlify","replace","str","temp","concat","Chapter","updateChapterNumberAndResetQuestionID","nextProps","ReactHtmlParser","Embed","websiteId","TextBookViewer","downloadJSON","bookRef","that","getDownloadURL","xhr","XMLHttpRequest","responseType","onload","event","bookJSON","parse","downloadSuccessful","open","send","code","onSidebarClick","updateJsonInFirebase","match","params","bookJSONObject","bgcolor","page","left","AuthContext","React","createContext","AuthProvider","useState","setCurrentUser","pending","setPending","useEffect","onAuthStateChanged","user","Provider","PrivateRoute","RouteComponent","rest","useContext","render","routeProps","AddBookScreen","documentLink","RegExp","exec","importSuccessful","_handleTextfieldChange","textAlign","placeholder","Home","searchIcon","background","newValue","closeIcon","onRequestSearch","onCancelSearch","Hero","ReactDOM","StrictMode","basename","path","SignIn","exact","document","getElementById","cheerio","splitHtml","splitOn","test","opts","$el","$","$matches","$match","$wrapper","second","cheerioOpts","result","splitAttr","token","ignoreAttr","load","eq","attr","markup","splitAt","indexOf","leftAt","lastIndexOf","first","substr","reopen","$parents","parents","$original","is","$parent","clone","empty","append","parentMarkup","endTagAt","tagName","removeAttr","remove","cleanup","Math","floor","random","toString","sanitizeHtml","allowedTags","defaults","DOMParser","parseFromString","cssStr","querySelectorAll","textContent","filtered","filterCss","getFilteredCSS","splitHtmlResult","chapterArray","title_with_h1","chapter_html","querySelector","module","exports","jQuery","c","s","find"],"mappings":"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","file":"static/js/main.fb1e89e6.chunk.js","sourcesContent":["import firebase from \"firebase\";\nrequire('firebase/auth')\n\nvar firebaseConfig = {\n    apiKey: \"AIzaSyCInI4F3bp_ie9o10iVc3tDVOfG0STBqHA\",\n    authDomain: \"picasso-298120.firebaseapp.com\",\n    projectId: \"picasso-298120\",\n    storageBucket: \"picasso-298120.appspot.com\",\n    messagingSenderId: \"980742080089\",\n    appId: \"1:980742080089:web:7c4fb1dc9c7cc3f7e99348\",\n    measurementId: \"G-JQDVJQK6T8\"\n};\n\n// init firebase\nif (!firebase.apps.length) {\n    firebase.initializeApp(firebaseConfig);\n}else {\n    firebase.app(); // if already initialized, use that one\n}\nfirebase.analytics();\n\nexport let f_db = firebase.firestore();\nexport let f_auth = firebase.auth();\nexport let auth = firebase.auth\nexport let f_storage_ref = firebase.storage().ref();\n\nexport default {f_db, f_auth, f_storage_ref};","// Import FirebaseAuth and firebase.\nimport React from 'react';\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport {auth, f_auth} from \"../config/firebase\";\n\n\nconst uiConfig = {\n    // Popup signin flow rather than redirect flow.\n    signInFlow: 'popup',\n    signInSuccessUrl: '/picasso/',\n    // We will display email as auth provider.\n    signInOptions: [\n        auth.EmailAuthProvider.PROVIDER_ID,\n    ],\n};\n\nfunction SignInScreen() {\n    return (\n        <div>\n            <StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={f_auth} />\n        </div>\n    );\n}\n\nexport default SignInScreen","export default __webpack_public_path__ + \"static/media/logo.f5577065.svg\";","export default __webpack_public_path__ + \"static/media/bookmark_border.7ab6e61e.svg\";","export default __webpack_public_path__ + \"static/media/note_add.deaa3c98.svg\";","export default __webpack_public_path__ + \"static/media/search.c49eb908.svg\";","export default __webpack_public_path__ + \"static/media/volume_up.f92f4a65.svg\";","\nimport {BookHTMLToJSON} from \"./BookHTMLToJSONBuilder\";\nimport {f_storage_ref} from \"../config/firebase\";\n\n\nfunction bring_it_in(docId) {\n    if (docId === null) return\n    console.log(docId)\n    // this.setState({bookID : docId, pending : true});\n    var url = \"https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id=\"+docId+\"&exportFormat=html\";\n    console.log(url)\n\n    fetch(url)\n        .then(response => response.text()\n        )\n        .then(contents => {\n            // console.log(contents)\n            conversion(contents, docId);\n        })\n        .catch(console.log)\n}\n\nfunction conversion(html, docID) {\n    let json = BookHTMLToJSON(html)\n    console.log(json)\n    upload(json, docID);\n}\n\nfunction upload (json, docID) {\n    let newBookRef = f_storage_ref.child(\"/books/\" + docID + \".json\");\n\n    var jsonString = JSON.stringify(json);\n\n    var blob = new Blob([jsonString], {type: \"application/json\"})\n\n    newBookRef.put(blob).then(function(snapshot) {\n        console.log('Uploaded ', docID, \".json\");\n        window.location.reload()\n    });\n\n}\nexport default function refresh(){\n\n    let url = new URL(window.location.href)\n\n    // http://localhost:3000/picasso/read/1zx7anhYvwI5d0TCsMH3jY4Ho3Ki7j5nBGB0kqO9VCLY\n    // 3 is the google document id!\n    let docID = url.hash.split(\"/\")[2];\n\n    console.log(url.hash)\n    bring_it_in(docID)\n}","import React, { Component } from 'react';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport './NavBar.css'\nimport BookMark from './svg/bookmark_border.svg'\nimport AddNote from './svg/note_add.svg'\nimport Search from './svg/search.svg'\nimport Audio from './svg/volume_up.svg'\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport refresh from \"../../../utils/refresh\";\n\nexport class Controls extends Component {\n\n    render() {\n        function handleClick(e) {\n            e.preventDefault();\n            console.log('The link was clicked.');\n        }\n        return(\n            <div className=\"navbar_controls\">\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={Audio} alt=\"play audio button\" onClick={handleClick}/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={BookMark} alt=\"bookmark button\"/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={AddNote} alt=\"add note button\"/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={Search} alt=\"search button\"/></IconButton>\n                <IconButton aria-label=\"upload picture\" component=\"span\" onClick={refresh}>\n                    <RefreshIcon/></IconButton>\n            </div>\n\n        )\n    }\n}\n\nexport default Controls;","import React, {Component} from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from \"@material-ui/core/Typography\";\nimport Card from \"@material-ui/core/Card\";\nimport DashboardIcon from '@material-ui/icons/Dashboard';\nimport onClickOutside from \"react-onclickoutside\";\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport {f_auth} from \"../../../../config/firebase\";\nimport {Link} from 'react-router-dom'\nimport AddBoxIcon from '@material-ui/icons/AddBox';\n\n\nclass AccountInformation extends Component {\n\n    handleClickOutside = evt => {\n        this.props.outsideClickHandler(evt)\n    };\n\n    logout = () => {\n        console.log(\"Logout\")\n        f_auth.signOut();\n    }\n\n    render() {\n        let style = {\n            minWidth: '15rem',\n            position : 'fixed',\n            top : '0',\n            right : '0',\n            margin : '5.5rem 2.8rem'\n        }\n        if (!this.props.show) {return null}\n\n        return (\n            <div style={style}>\n\n            <Card>\n                    <Typography variant=\"h6\" align=\"center\" style={{marginTop : '1rem'}}>Hi, {f_auth.currentUser.displayName || null}!</Typography>\n\n                <Divider/>\n\n                <List component=\"nav\" aria-label=\"main mailbox folders\">\n                    <ListItem button onClick={this.import}>\n\n                        <Link to={\"/add\"} style = {{display : 'flex', textDecoration : 'none', color: 'black'}}>\n                            <ListItemIcon>\n                                <AddBoxIcon />\n                            </ListItemIcon>\n\n                            <ListItemText primary=\"Import\" />\n                        </Link>\n                    </ListItem>\n                    <ListItem button>\n                        <ListItemIcon>\n                            <DashboardIcon />\n                        </ListItemIcon>\n                        <ListItemText primary=\"Dashboard\" />\n                    </ListItem>\n                    <ListItem button onClick={this.logout}>\n                        <ListItemIcon>\n                            <ExitToAppIcon />\n                        </ListItemIcon>\n                        <ListItemText primary=\"Logout\" />\n                    </ListItem>\n                </List>\n\n            </Card>\n            </div>\n        );\n    }\n}\n\nexport default onClickOutside(AccountInformation);\n","import './NavBar.css';\nimport Logo from './svg/logo.svg'\nimport Controls from './Controls'\nimport Avatar from \"@material-ui/core/Avatar\";\nimport React, {Component} from 'react';\nimport AccountInformation from \"./Account/AccountInformation\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport {f_auth} from \"../../../config/firebase\";\n\nclass NavBar extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            showAccountInformation: false\n        }\n    }\n    // prevents dragging of the icons.\n    preventDragHandler = (e) => {\n        e.preventDefault();\n    };\n\n    avatarClicked = () => {\n        console.log(\"Avatar clicked.\")\n        this.setState({showAccountInformation : !this.state.showAccountInformation})\n    }\n\n    clickedOutsideHandler = (e) => {\n        if (e.target.id !== \"avatar_btn\"){\n            console.log(\"clicked outside\", e)\n            this.setState({showAccountInformation : false})\n        }\n    }\n\n    render(){\n\n        let name = f_auth.currentUser.displayName || \"\"\n\n        return (\n            <div onDragStart={this.preventDragHandler}>\n                <div className=\"navbar\">\n                    <img src={Logo} height=\"50rem\" alt=\"company logo\"/>\n                    <Controls/>\n                    <IconButton onClick={this.avatarClicked} ><Avatar className=\"avatar\" id=\"avatar_btn\">{name.charAt(0).toUpperCase() || null}</Avatar></IconButton>\n                </div>\n                <AccountInformation show = {this.state.showAccountInformation} outsideClickHandler = {this.clickedOutsideHandler}/>\n            </div>\n        );\n    }\n\n}\n\n\nexport default NavBar;","export default __webpack_public_path__ + \"static/media/bookmark_border.da01c847.svg\";","import React, {Component} from \"react\";\nimport BookMark from './svg/bookmark_border.svg'\nimport Button from \"@material-ui/core/Button\";\nimport { withStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Chip from \"@material-ui/core/Chip\";\nimport {Avatar} from \"@material-ui/core\";\n\nexport class SideBar extends Component{\n\n    render() {\n        let chapterList = this.props.book.chapters;\n        const SideBarElementList = []\n\n        let sidebar_style = {\n            marginTop: '3rem',\n            display: 'inline-flex',\n            flexDirection: 'column',\n            position: 'fixed'\n        };\n\n        const StyledButton = withStyles({\n            root: {\n                borderRadius: '0',\n                fontSize: '1rem',\n                fontWeight: '400',\n                padding: '0',\n                borderBottomRightRadius: '3rem',\n                borderTopRightRadius: '3rem'\n            },\n            label: {\n                textTransform: 'none',\n            },\n        })(Button);\n\n        for (const [index, chapter] of chapterList.entries()) {\n            SideBarElementList.push(<StyledButton key = {index} onClick = {() => this.props.handler(index)}><SideBarElement name = {chapter.name}\n                                                                                isBookmarked = {chapter.isBookmarked}\n                                                                                isSelected = {index === this.props.currentSelectedChapter}\n                                                                                index = {index}\n            /></StyledButton>)\n        }\n\n        return(\n            <div style={sidebar_style}>\n                {SideBarElementList}\n            </div>\n        );\n    }\n}\n\nlet SideBarElement = function statelessFunctionComponentClass(props) {\n\n    let isBookmarked = props.isBookmarked;\n    let name = props.name.trim();\n    let isSelected = props.isSelected;\n    let style = {\n        width: '13rem',\n        height: '3.5rem',\n        paddingLeft: '1.5rem',\n        paddingRight: '1rem',\n        display: 'inline-flex',\n        alignItems: 'center',\n        backgroundColor: isSelected ? '#E3F2FD' : '',\n        borderBottomRightRadius: '3rem',\n        borderTopRightRadius: '3rem',\n        color : isSelected ? '#2196F3' : 'black',\n        fontWeight: '500',\n    };\n\n    let textStyle = {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap'\n    }\n\n    const HtmlTooltip = withStyles((theme) => ({\n        tooltip: {\n            fontSize: theme.typography.pxToRem(12),\n        },\n    }))(Tooltip);\n\n    let chipStyle = {\n        marginRight: '0.5rem',\n        color : isSelected ? 'white' : 'black',\n        backgroundColor : isSelected ? '#2196F3' : '',\n    }\n\n\n    return (\n        <HtmlTooltip title = {name} arrow placement=\"right\">\n        <div style={style}>\n            <Chip size=\"small\" label= {props.index + 1} style={chipStyle} variant={isSelected ? 'default' : 'outlined'}/>\n\n            <span style={textStyle}>{name}</span>\n        </div>\n        </HtmlTooltip>\n    );\n};","import React, {Component} from \"react\";\nimport {Button, Divider} from \"@material-ui/core\";\nimport TextField from \"@material-ui/core/TextField\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport { RadioGroup, RadioButton } from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class ResponseQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            oldResponse : \"\",\n            needsFirebaseLoading : true,\n            dirty: false,\n        }\n    }\n\n    saveResponse = () => {\n        if (this.state.response == \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase();\n        this.setState({hasResponded : true})\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (e) => {\n        console.log(\"onChangeResponse\")\n        this.setState({response : e.target.value})\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"RESPONSE_QUESTION\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                    referenceToOldThis.setState({dirty : true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = () => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"RESPONSE_QUESTION\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                referenceToOldThis.setState({dirty : true})\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response : referenceToOldThis.state.response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: referenceToOldThis.state.response,\n                        bookID : referenceToOldThis.props.bookID,\n                        type: \"RESPONSE_QUESTION\"\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    cancelEdit = () => {\n        this.setState({response : this.state.oldResponse})\n        this.setState({hasResponded : true})\n    }\n\n    render() {\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let questionText = this.props.questionText;\n\n        let responseFieldStyle = {\n            width: '100%',\n            marginBottom : '1rem',\n            marginTop : '1rem'\n        }\n\n        let responseQuestion =\n            <Box className='responseQuestionBox' boxShadow = {2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{questionText[1].trim()}</b></p>\n                    <TextField\n                        style={responseFieldStyle}\n                        label=\"Response\"\n                        multiline\n                        onChange={this.onChangeResponse}\n                        defaultValue={this.state.response}\n                    />\n                    <div>\n                        <Button variant=\"contained\" color=\"primary\" style={{float : 'right'}} onClick={this.saveResponse}>RESPOND</Button>\n                        <Button variant=\"contained\" color=\"delete\" style={{float : 'right', marginRight: '1rem', visibility : this.state.dirty ? 'visible' : 'hidden'}} onClick={this.cancelEdit}>Cancel</Button>\n                    </div>\n                </div>\n            </Box>\n\n        let responseQuestionRespondedView =\n            <Box className='responseQuestionBox' boxShadow = {2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{questionText[1].trim()}</b></p>\n                    <Divider/>\n                    <p className=\"p-no-margin\">{this.state.response}</p>\n                    <div style={{float : 'right'}}>\n                        <Button variant=\"contained\" onClick={this.onEdit}>EDIT</Button>\n                    </div>\n                </div>\n            </Box>\n\n        if (this.state.hasResponded){\n            return responseQuestionRespondedView;\n        }\n        else return responseQuestion;\n    }\n}","import React, {Component} from \"react\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport {RadioButton, RadioGroup} from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class TrueFalseQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            needsFirebaseLoading : true,\n            error: false,\n        }\n    }\n\n    saveResponse = (response) => {\n        if (response === \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase(response);\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (value) => {\n        console.log(\"onChangeResponse\", value)\n        this.setState({response : value})\n        this.saveResponse(value)\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"TRUE_OR_FALSE\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    if (doc.data().type !== \"TRUE_OR_FALSE\"){\n                        console.log(\"ERROR, QUESTION TYPE MISMATCH\");\n                        referenceToOldThis.setState({error : true})\n                        return ;\n                    }\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = (response) => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"TRUE_OR_FALSE\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response :  response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: response,\n                        type: \"TRUE_OR_FALSE\",\n                        bookID : referenceToOldThis.props.bookID\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    cancelEdit = () => {\n        this.setState({response : this.state.oldResponse})\n        this.setState({hasResponded : true})\n    }\n\n    render() {\n\n        if (this.state.error) {\n            return <div>ERROR RENDERING QUESTION. Please contact us.</div>\n        }\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let questionText = this.props.questionText;\n        let question = questionText[1].split(\">\")[0].trim();\n        let correctAnswer = questionText[1].split(\">\")[1].trim().toUpperCase();\n\n        if (this.state.hasResponded) {\n            return <Box className='responseQuestionBox' boxShadow={2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{question}</b></p>\n                    <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                        <RadioGroup onChange={this.onChangeResponse} value={this.state.response} horizontal>\n                            <RadioButton value=\"TRUE\"\n                                         rootColor={\"black\"}\n                                         pointColor={correctAnswer === \"TRUE\" ? \"green\" : \"red\"}>\n                                <b>TRUE</b>\n                            </RadioButton>\n\n                            <RadioButton value=\"FALSE\"\n                                         rootColor={\"black\"}\n                                         pointColor={correctAnswer === \"FALSE\" ? \"green\" : \"red\"}>\n                                <b>FALSE</b>\n                            </RadioButton>\n                        </RadioGroup>\n                    </div>\n                </div>\n            </Box>;\n        }\n\n        return <Box className='responseQuestionBox' boxShadow={2}>\n            <div style={{width: '100%'}}>\n                <p className=\"p-no-margin\"><b>{question}</b></p>\n                <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                    <RadioGroup onChange={this.onChangeResponse} horizontal>\n                        <RadioButton value=\"TRUE\"\n                                     rootColor={\"black\"}\n                                     pointColor={correctAnswer === \"TRUE\" ? \"green\" : \"red\"}>\n                            <b>TRUE</b>\n                        </RadioButton>\n\n                        <RadioButton value=\"FALSE\"\n                                     rootColor={\"black\"}\n                                     pointColor={correctAnswer === \"FALSE\" ? \"green\" : \"red\"}>\n                            <b>FALSE</b>\n                        </RadioButton>\n                    </RadioGroup>\n                </div>\n            </div>\n        </Box>;\n\n    }\n}","import React, {Component} from \"react\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport {RadioButton, RadioGroup} from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class MultipleChoiceQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n\n        let questionText = this.props.questionText;\n        let question = questionText[1].split(\">\")[0].trim();\n\n        var choicesArray = questionText[1].split(\">\").slice(1, questionText[1].split(\">\").length - 1)\n        let correctAnswer = parseInt(questionText[1].split(\">\")[questionText[1].split(\">\").length - 1].trim())\n\n        const items = []\n\n        for (const [index, value] of choicesArray.entries()) {\n            items.push(<RadioButton key={index}\n                                    value = {index + 1}\n                                    rootColor={\"black\"}\n                                    pointColor={correctAnswer === index + 1 ? \"green\" : \"red\"}\n            > {value.trim()} </RadioButton>)\n        }\n\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            needsFirebaseLoading : true,\n            error: false,\n            question : question,\n            items : items,\n            choicesArray: choicesArray,\n        }\n    }\n\n    saveResponse = (response) => {\n        if (response === \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase(response);\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (value) => {\n        console.log(\"onChangeResponse\", value)\n        this.setState({response : value})\n        this.saveResponse(value)\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"MULTIPLE_CHOICE\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    if (doc.data().type !== \"MULTIPLE_CHOICE\"){\n                        console.log(\"ERROR, QUESTION TYPE MISMATCH\");\n                        referenceToOldThis.setState({error : true})\n                        return ;\n                    }\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = (response) => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"MULTIPLE_CHOICE\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response : response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: response,\n                        type: \"MULTIPLE_CHOICE\",\n                        bookID : referenceToOldThis.props.bookID\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n\n    render() {\n\n        if (this.state.error) {\n            return <div>ERROR RENDERING QUESTION. Please contact us.</div>\n        }\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let question = this.state.question;\n        let items = this.state.items;\n\n\n        if (this.state.hasResponded) {\n            return <Box className='responseQuestionBox' boxShadow={2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{question}</b></p>\n                    <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                        <RadioGroup onChange={this.onChangeResponse} value={this.state.response} vertical>\n                            {items.map(item => {\n                                return item\n                            })}\n                        </RadioGroup>\n                    </div>\n                </div>\n            </Box>;\n        }\n\n        return <Box className='responseQuestionBox' boxShadow={2}>\n            <div style={{width: '100%'}}>\n                <p className=\"p-no-margin\"><b>{question}</b></p>\n                <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                    <RadioGroup onChange={this.onChangeResponse} vertical>\n                        {items.map(item => {\n                            return item\n                        })}\n                    </RadioGroup>\n                </div>\n            </div>\n        </Box>;\n    }\n}","import React, {Component} from \"react\";\nimport ReactHtmlParser, {convertNodeToElement} from 'react-html-parser';\nimport ReactPlayer from \"react-player\";\nimport './css/styles.css'\nimport {f_auth, f_db} from '../../../config/firebase'\nimport HashMap from 'hashmap'\nimport {ResponseQuestion} from \"./Question/ResponseQuestion\";\nimport HyvorTalk from \"hyvor-talk-react\";\nimport {TrueFalseQuestion} from \"./Question/TrueFalseQuestion\";\nimport {MultipleChoiceQuestion} from \"./Question/MultipleChoiceQuestion\";\nimport {Box} from \"@material-ui/core\"\n\n// this will save responses for the student in a hashmap;\nvar responseMap = new HashMap();\n\nvar sanitizeHtml = require('sanitize-html');\n\n// global variable to hold the chapter number.\nvar currentChapter = null;\nvar newQuestionId = null;\nvar bookID = null;\n\n\n// TODO: this is the real parser, it needs to be updated to be able to handle images nested in p tags and some scenarios.\n// TODO (known bug): if image is precedded or followed by a QUESTION TYPE, it wont render the image unless the image is\n//  set to be break-text in google docs.\n\nfunction contains(node, tag){\n    if (node === null) return false;\n    if (node.children === undefined) return false;\n\n    // does it have children?\n    for (var i = 0; i < node.children.length; i++){\n        if (node.children[i].name === tag) return true;\n        if (contains(node.children[i], tag) === true) return true;\n    }\n\n    return false;\n}\n\nfunction transform(node, index) {\n    if (node.type === 'tag' && node.name.startsWith('h')){\n        let elementText = getText(node,String());\n        if(!elementText.trim()) return null;\n    }\n\n    if (node.type === 'tag' && node.name === 'img'){\n        console.log(\"IMG FOUND\")\n        return <img src={node.attribs[\"src\"]}  className=\"chapter_img\" alt=\"chapter_img\"/>\n    }\n\n    if (node.type === 'tag' && node.name === 'span'){\n        console.log(\"SPAN FOUND\", node)\n        node.attribs.style = null;\n        return convertNodeToElement(node, index, transform)\n    }\n\n    // TODO: fix image rendering for all cases.\n    if (node.type === 'tag' && node.name === 'p') {\n        console.log(\"P FOUND\", node)\n        // add code to transform any nodes as neccesary\n        let questionText = getText(node,String());\n\n        console.log(contains(node, 'img'))\n\n        if (!questionText.trim() && !contains(node, 'img')) return null;\n\n        if (questionText.startsWith(\"RESPONSE_QUESTION\")){\n\n            let question = questionText.split(\":\")\n\n            return <ResponseQuestion questionNumber = {newQuestionId++}\n                                     chapterNumber={currentChapter}\n                                     questionText = {question}\n                                     bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"TRUE_OR_FALSE\")){\n\n            let question = questionText.split(\":\")\n\n            return <TrueFalseQuestion questionNumber = {newQuestionId++}\n                                      chapterNumber={currentChapter}\n                                      questionText = {question}\n                                      bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"MULTIPLE_CHOICE\")){\n\n            let question = questionText.split(\":\")\n\n            return <MultipleChoiceQuestion questionNumber = {newQuestionId++}\n                                      chapterNumber={currentChapter}\n                                      questionText = {question}\n                                      bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"VIDEO_LINK\")){\n            return <Box display={'flex'} justifyContent={\"center\"}>\n                <ReactPlayer url = {urlify(questionText)} />\n            </Box>\n\n        }\n\n        return convertNodeToElement(node, index, transform)\n    }\n}\n\nfunction urlify(text) {\n    var urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n    return text.replace(urlRegex, function(url) {\n        return url\n    })\n}\n\n\nfunction responseChanged(event){\n    responseMap.set(event.target.id, event.target.value)\n    console.log(responseMap)\n}\n\nfunction saveResponse(e){\n    let questionNumber = parseInt(e.currentTarget.id)\n    let studentID = f_auth.currentUser.uid;\n    var responseAlreadyExists = false;\n    let hashKey = e.currentTarget.id;\n\n    if(responseMap.get(hashKey) == null) {\n        console.log(\"Please type an answer first.\")\n        return ;\n    }\n\n    // perform a query and see if response already exists in the database for the student.\n    var query = f_db.collection(\"answers\");\n    query = query.where(\"studentID\", \"==\", studentID)\n    query = query.where(\"chapterNumber\", \"==\", currentChapter)\n    query = query.where(\"questionNumber\", \"==\" , questionNumber)\n\n    query.get()\n        .then(function(querySnapshot) {\n            // if document exists then update it else create one\n            querySnapshot.forEach(function(doc) {\n                doc.ref.update({response : responseMap.get(hashKey)})\n                responseAlreadyExists = true;\n            });\n            // if response didnt already exist in the database, add the new response.\n            if (!responseAlreadyExists){\n                query = f_db.collection(\"answers\").add({\n                    studentID: studentID,\n                    chapterNumber: currentChapter,\n                    questionNumber: questionNumber\n                })\n                    .then(function(docRef) {\n                        console.log(\"New answer recorded with ID: \", docRef.id);\n                    })\n                    .catch(function(error) {\n                        console.error(\"Error adding answer: \", error);\n                    });\n            }\n            else {\n                console.log(\"Response updated\")\n            }\n        })\n        .catch(function(error) {\n            console.error(\"Error updating answer: \", error);\n        });\n}\n\nfunction getText(node, str) {\n    // see if there are children\n    if (node.type === 'text'){\n        return (node.data);\n    }\n\n    for (const child in node.children) {\n        let temp = str.concat(getText(node.children[child], String()))\n        str = temp;\n    }\n    return str;\n}\n\nexport class Chapter extends Component {\n\n    constructor(props) {\n        super(props);\n        this.updateChapterNumberAndResetQuestionID(props.chapterNumber)\n        bookID = this.props.bookID;\n        console.log(props.html)\n    }\n\n    componentWillReceiveProps(nextProps){\n        this.updateChapterNumberAndResetQuestionID(nextProps.chapterNumber)\n    }\n\n    // resets the global variables that keep track of currentchapter and questionID\n    updateChapterNumberAndResetQuestionID(chapterNumber){\n        newQuestionId = 1;\n        currentChapter = chapterNumber;\n    }\n\n    render() {\n\n        console.log(\"Chapter Number\", currentChapter)\n\n        console.log(\"STYLE \", this.props.style)\n\n        let html =\n            \"<html>\" +\n            this.props.style +\n            this.props.html +\n            \"</html>\"\n        ;\n\n\n        let style = {\n            width: '55%',\n            margin: '0 auto'\n        };\n\n        return(\n            <div style={style}>\n                {ReactHtmlParser(html, {transform})}\n                <HyvorTalk.Embed\n                    websiteId={2736}\n                    id={this.props.bookID+\"CHAPTER\"+currentChapter}\n                    key = {currentChapter}\n                />\n            </div>\n        );\n    }\n}\n\n","import \"./TextBookViewer.css\"\nimport NavBar from \"./Components/Navbar/NavBar\"\nimport {SideBar} from \"./Components/SideBar/SideBar\";\nimport {Chapter} from \"./Components/Chapter/Chapter\"\nimport React, {Component} from \"react\";\nimport ProgressBar from \"react-scroll-progress-bar\";\nimport {f_storage_ref} from \"../config/firebase\";\nimport ReactLoading from \"react-loading\";\nimport MediaQuery from 'react-responsive';\n\nclass TextBookViewer extends Component{\n\n    constructor(props) {\n        super(props);\n        console.log(\"Constructor called.\", props.match.params.bookID)\n        this.state = {\n            downloadSuccessful : false,\n            currentChapter : 0,\n            bookID : this.props.match.params.bookID,\n            bookJSON : null\n        }\n    }\n\n    componentDidMount() {\n        this.downloadJSON(this.state.bookID);\n        console.log(\"BOOK ID\", this.state.bookID);\n    }\n\n    downloadJSON = (bookID) => {\n\n        // Create a reference to the file we want to download\n        var bookRef = f_storage_ref.child('books/' + bookID + \".json\");\n\n        // Get the download URL\n        let prefixCORS = \"https://cors-anywhere.herokuapp.com/\";\n\n        let that = this;\n        bookRef.getDownloadURL().then(function(url) {\n            // Insert url into an <img> tag to \"download\"\n            var xhr = new XMLHttpRequest();\n            xhr.responseType = 'blob';\n            xhr.onload = function(event) {\n                var blob = xhr.response;\n                blob.text().then(text => {\n                    that.setState({bookJSON : (JSON.parse(text)),\n                                         downloadSuccessful: true})\n                })\n            };\n            xhr.open('GET', prefixCORS + url);\n            xhr.send();\n        }).catch(function(error) {\n\n            // A full list of error codes is available at\n            // https://firebase.google.com/docs/storage/web/handle-errors\n            switch (error.code) {\n                case 'storage/object-not-found':\n                    // File doesn't exist\n                    break;\n\n                case 'storage/unauthorized':\n                    // User doesn't have permission to access the object\n                    break;\n\n                case 'storage/canceled':\n                    // User canceled the upload\n                    break;\n\n                case 'storage/unknown':\n                    // Unknown error occurred, inspect the server response\n                    break;\n            }\n        });\n    }\n\n    render() {\n\n        let canvasStyle = {\n            display: 'flex',\n            flexDirection: 'row'\n        };\n\n        if(this.state.downloadSuccessful){\n\n            let bookJSONObject = this.state.bookJSON\n\n            console.log(bookJSONObject);\n\n            return (\n                <div>\n                    <ProgressBar\n                        height = \"4px\"\n                        bgcolor = \"#1d85d2\"\n                    />\n                    <NavBar/>\n                    <div style={canvasStyle}>\n                        <SideBar handler = {this.onSidebarClick}\n                                 currentSelectedChapter = {this.state.currentChapter}\n                                 book = {bookJSONObject.book}/>\n\n                        <Chapter html = {bookJSONObject.book.chapters[this.state.currentChapter].page.html}\n                                 style = {bookJSONObject.book.style}\n                                 chapterNumber = {this.state.currentChapter}\n                                 bookID = {this.state.bookID}\n                        />\n                    </div>\n                </div>\n            );\n        }\n        else {\n            return <div\n                style={{\n                    position: 'absolute', left: '50%', top: '50%',\n                    transform: 'translate(-50%, -50%)'\n                }}>\n\n                <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n            </div>\n        }\n    }\n\n    onSidebarClick = (index) => {\n\n        // this.state.bookJSON.book[\"currentSelectedChapter\"] = index;\n        this.updateJsonInFirebase();\n        this.setState({currentChapter : index})\n    }\n\n    updateJsonInFirebase = () => {\n        console.log(\"TODO: Implement firebase JSON update.\")\n    }\n}\n\nexport default TextBookViewer;\n","import React, { useEffect, useState } from \"react\";\nimport {f_auth} from \"./config/firebase\";\nimport ReactLoading from 'react-loading';\n\nexport const AuthContext = React.createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [currentUser, setCurrentUser] = useState(null);\n    const [pending, setPending] = useState(true);\n\n    useEffect(() => {\n        f_auth.onAuthStateChanged((user) => {\n            console.log(user)\n            setCurrentUser(user)\n            setPending(false)\n        });\n    }, []);\n\n    if(pending){\n        return <div\n            style={{\n                position: 'absolute', left: '50%', top: '50%',\n                transform: 'translate(-50%, -50%)'\n            }}\n        >\n             <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n        </div>\n\n    }\n\n    return (\n        <AuthContext.Provider\n            value={{\n                currentUser\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n};","import React, { useContext } from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\nimport { AuthContext } from \"./Auth\";\n\nconst PrivateRoute = ({ component: RouteComponent, ...rest }) => {\n\n    const {currentUser} = useContext(AuthContext);\n\n    console.log(currentUser);\n    return (\n        <Route\n            {...rest}\n            render={routeProps =>\n                !!currentUser ? (\n                    <RouteComponent {...routeProps} />\n                ) : (\n                    <Redirect to={\"/signin/\"} />\n                )\n            }\n        />\n    );\n};\n\n\nexport default PrivateRoute","import React from \"react\";\nimport {TextField} from \"@material-ui/core\";\nimport {Button} from \"@material-ui/core\";\nimport {Box} from \"@material-ui/core\";\nimport {Redirect } from \"react-router-dom\";\nimport {BookHTMLToJSON} from \"../utils/BookHTMLToJSONBuilder\";\nimport {f_storage_ref} from \"../config/firebase\"\nimport ReactLoading from \"react-loading\";\n\nexport default class AddBookScreen extends React.Component{\n\n    constructor(props) {\n        super(props);\n        this.state =  {\n            importSuccessful : false,\n            bookID : \"\",\n            documentLink : \"\",\n            pending : false,\n        }\n    }\n\n    import = () => {\n        if (this.state.documentLink === '') return ;\n        var docId = new RegExp(\"/document/d/([a-zA-Z0-9-_]+)\").exec(this.state.documentLink)[1];\n        console.log(docId)\n        this.setState({bookID : docId, pending : true});\n        var url = \"https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id=\"+docId+\"&exportFormat=html\";\n        console.log(url)\n\n        fetch(url)\n            .then(response => response.text()\n            )\n            .then(contents => {\n                // console.log(contents)\n                this.conversion(contents);\n            })\n            .catch(console.log)\n    }\n\n    conversion = (html) => {\n        let json = BookHTMLToJSON(html)\n        console.log(json)\n        this.upload(json);\n    }\n\n    upload = (json) => {\n        let newBookRef = f_storage_ref.child(\"/books/\" + this.state.bookID + \".json\");\n\n        var jsonString = JSON.stringify(json);\n\n        var blob = new Blob([jsonString], {type: \"application/json\"})\n\n        let that = this\n        newBookRef.put(blob).then(function(snapshot) {\n            console.log('Uploaded ', that.state.bookID, \".json\");\n            that.setState({importSuccessful : true, pending : false})\n\n        });\n\n    }\n\n    _handleTextfieldChange = (e) => {\n        this.setState({documentLink : e.target.value})\n    }\n\n    render() {\n        console.log(\"PROPS\", this.props)\n        if (this.props.match)\n        {\n            console.log(this.props.match.params.bookID)\n        }\n\n        if (this.state.importSuccessful){\n            return <Redirect to={\"../read/\" + this.state.bookID}/>\n        }\n\n        if (this.state.pending){\n            return <div\n                style={{\n                    position: 'absolute', left: '50%', top: '50%',\n                    transform: 'translate(-50%, -50%)'\n                }}\n            >\n                <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n            </div>\n        }\n\n        return <div>\n                <h3 style={{textAlign : 'center'}}>What's your Google Doc link?</h3>\n                <Box display=\"flex\" justifyContent=\"center\">\n                    <TextField id=\"outlined-basic\" placeholder={\"https://docs.google.com/document/...\"} variant=\"outlined\" style={{width : '40rem'}} onChange={this._handleTextfieldChange} />\n                    <Button type={\"submit\"} color=\"primary\" onClick={() => {this.import()}}>IMPORT</Button>\n                </Box>\n            </div>\n    }\n}","export default __webpack_public_path__ + \"static/media/Logo.d37141a7.svg\";","export default __webpack_public_path__ + \"static/media/Hero.82d2f637.svg\";","import React, {Component} from \"react\";\nimport Logo from \"./svg/Logo.svg\"\nimport Hero from \"./svg/Hero.svg\"\nimport Box from \"@material-ui/core/Box\";\nimport \"./css/styles.css\"\nimport SearchBar from \"material-ui-search-bar\";\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport {BookHTMLToJSON} from \"../utils/BookHTMLToJSONBuilder\";\nimport {f_storage_ref} from \"../config/firebase\";\nimport {Redirect} from \"react-router-dom\";\nimport ReactLoading from \"react-loading\";\n\nexport default class Home extends Component{\n\n    constructor(props) {\n        super(props);\n        this.state =  {\n            importSuccessful : false,\n            bookID : \"\",\n            documentLink : \"\",\n            pending : false\n        }\n    }\n\n    import = () => {\n        if (this.state.documentLink === '') return ;\n        var docId = new RegExp(\"/document/d/([a-zA-Z0-9-_]+)\").exec(this.state.documentLink)[1];\n        console.log(docId)\n        this.setState({bookID : docId, pending : true});\n        var url = \"https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id=\"+docId+\"&exportFormat=html\";\n        console.log(url)\n\n        fetch(url)\n            .then(response => response.text()\n            )\n            .then(contents => {\n                // console.log(contents)\n                this.conversion(contents);\n            })\n            .catch(console.log)\n    }\n\n    conversion = (html) => {\n        let json = BookHTMLToJSON(html)\n        console.log(json)\n        this.upload(json);\n    }\n\n    upload = (json) => {\n        let newBookRef = f_storage_ref.child(\"/books/\" + this.state.bookID + \".json\");\n\n        var jsonString = JSON.stringify(json);\n\n        var blob = new Blob([jsonString], {type: \"application/json\"})\n\n        let that = this\n        newBookRef.put(blob).then(function(snapshot) {\n            console.log('Uploaded ', that.state.bookID, \".json\");\n            that.setState({importSuccessful : true, pending : false})\n\n        });\n\n    }\n\n    _handleTextfieldChange = (e) => {\n        this.setState({documentLink : e.target.value})\n    }\n\n    render() {\n\n        if (this.state.importSuccessful){\n            return <Redirect to={\"../read/\" + this.state.bookID}/>\n        }\n\n        if (this.state.pending){\n            return <div\n                style={{\n                    position: 'absolute', left: '50%', top: '50%',\n                    transform: 'translate(-50%, -50%)'\n                }}\n            >\n                <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n            </div>\n        }\n\n        let hero_box_background = {\n            background: \"#E3F2FD\",\n            height: '600px'\n        }\n\n        let searchIcon = <ArrowForwardIcon/>\n        return(\n            <div>\n                <div style={hero_box_background}>\n                    <Box display={\"flex\"} justifyContent={\"center\"} className={\"navbar\"}><img src={Logo}/> </Box>\n                    <Box>\n                        <h1 id={\"heading_line\"}>Publish beautiful, interactive textbooks<br/>\n                            using only Google Docs.</h1>\n                    </Box>\n\n                    <Box display = {\"flex\"}\n                         justifyContent={\"center\"}\n                    >\n                        <SearchBar\n                            value={this.state.documentLink}\n                            onChange={(newValue) => this.setState({ documentLink: newValue })}\n                            placeholder = \"Your Google Doc link\"\n                            searchIcon={searchIcon}\n                            closeIcon={searchIcon}\n                            style={{width : '25rem'}}\n                            onRequestSearch={() => {this.import()}}\n                            onCancelSearch={() => {this.import()}}\n                        />\n\n                    </Box>\n                    <Box display={\"flex\"} justifyContent={\"center\"} className={\"navbar\"}><img src={Hero}/> </Box>\n                </div>\n            </div>\n        )\n    }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {HashRouter as Router, Switch, Route, Redirect} from 'react-router-dom'\nimport SignInScreen from \"./Login/SignIn\";\nimport TextBookViewer from \"./Textbook/TextBookViewer\";\nimport {AuthProvider} from \"./Auth\";\nimport PrivateRoute from \"./PrivateRoute\";\nimport AddBookScreen from \"./AddBook/AddBookScreen\"\nimport Home from \"./Home/home\";\n\nlet DEBUG_MODE_ON = true;\n\nif (!DEBUG_MODE_ON) {\n    console = console || {};\n    console.log = function(){};\n}\n\nconsole.log(\"index.js called.\")\n\nReactDOM.render(\n  <React.StrictMode>\n      <AuthProvider>\n          <Router basename = '/'>\n              <Switch>\n                  <Route path=\"/signin/\"> <SignInScreen /> </Route>\n                  <Route path=\"/add/\" exact> <AddBookScreen /> </Route>\n                  <Route path=\"/home/\"> <Home/> </Route>\n                  <PrivateRoute path=\"/read/:bookID\" exact component={TextBookViewer}></PrivateRoute>\n                  <Route path=\"*\"><Redirect to=\"/home/\" /></Route>\n              </Switch>\n          </Router>\n      </AuthProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","// take the HTML from Google doc API\n// Split it into Chapters and build the sample_book.json.\n\nimport jQuery from 'jquery';\nimport { parse } from 'node-html-parser';\n\nvar cheerio;\n\nif (typeof window === 'undefined') {\n    // node\n    module.exports = splitHtml;\n    cheerio = require('cheerio');\n} else {\n    window.splitHtml = splitHtml;\n    // In the browser, use actual jQuery in place of Cheerio.\n    // Create a simulated cheerio object.\n    cheerio = {\n        load: function(html) {\n            var $wrapper = jQuery('<div data-cheerio-root>');\n            var $el = jQuery(html);\n            $wrapper.append($el);\n            function c(s) {\n                if (s[0] === '<') {\n                    return jQuery(s);\n                }\n                return $wrapper.find(s);\n            }\n            c.html = function() {\n                return $wrapper.html();\n            };\n            return c;\n        },\n    };\n}\n\nfunction splitHtml(html, splitOn, test, opts) {\n    if (!test) {\n        test = function($el) {\n            return true;\n        };\n    }\n    opts = opts || {};\n    var cheerioOpts = opts.cheerio || null;\n    var result = [];\n    var splitAttr = 'data-' + token();\n    var ignoreAttr = 'data-' + token();\n    var $;\n    var $matches;\n    var i;\n    var $match;\n    var $wrapper;\n    var tag;\n    var second;\n    while (true) {\n        $ = cheerio.load(html, cheerioOpts);\n        $matches = $(splitOn);\n        $match = null;\n        for (i = 0; (i < $matches.length); i++) {\n            $match = $matches.eq(i);\n            if ((!$match.attr(ignoreAttr)) && test($match)) {\n                break;\n            } else {\n                $match.attr(ignoreAttr, '1');\n            }\n            $match = null;\n        }\n        if (!$match) {\n            result.push(html);\n            break;\n        }\n        $match.attr(splitAttr, '1');\n        var markup = $.html();\n        var splitAt = markup.indexOf(splitAttr);\n        var leftAt = markup.lastIndexOf('<', splitAt);\n        if (leftAt === -1) {\n            result.push(html);\n            break;\n        }\n        var first = markup.substr(0, leftAt);\n\n        // For the second segment we need to reopen the\n        // open tags from the first segment. Reconstruct that.\n\n        var reopen = '';\n        $wrapper = cheerio.load('<div></div>')('div').eq(0);\n        var $parents = $match.parents();\n        for (i = 0; (i < $parents.length); i++) {\n            var $original = $parents.eq(i);\n            if ($original.is('[data-cheerio-root]')) {\n                // Simulated cheerio used in browser has\n                // a wrapper element\n                break;\n            }\n            var $parent = $original.clone();\n            $parent.empty();\n            $wrapper.empty();\n            $wrapper.append($parent);\n            var parentMarkup = $wrapper.html();\n            var endTagAt = parentMarkup.indexOf('>');\n            tag = tagName($parent);\n            // Cheerio tolerates missing closing tags,\n            // but real jQuery will discard any text\n            // preceding them, so play nice\n            first += '</' + tag + '>';\n            reopen = parentMarkup.substr(0, endTagAt + 1) + reopen;\n        }\n\n        // We can't just split off the next fragment at\n        // > because the matching tag may be a container.\n        // Move it to a wrapper to get its full markup,\n        // then remove it from the original document. The\n        // remainder of the original document now begins\n        // where the matching tag used to\n\n        markup = $.html();\n\n        $wrapper = cheerio.load('<div></div>')('div').eq(0);\n        $match.removeAttr(splitAttr);\n        $wrapper.append($match);\n        tag = $wrapper.html();\n        $match.remove();\n        markup = $.html();\n        second = reopen + markup.substr(leftAt);\n        // Let Cheerio close the open tags in the\n        // first segment for us. Also mop up the attributes\n        // we used to mark elements that matched the selector\n        // but didn't match our test function\n        first = cleanup(first);\n        result.push(first);\n        result.push(tag);\n        html = cleanup(second);\n    }\n    return result;\n    // Use Cheerio to strip out any attributes we used to keep\n    // track of our work, then generate new HTML. This also\n    // closes any tags we opened but did not close.\n    function cleanup(html) {\n        html = cheerio.load(html, cheerioOpts);\n        html('[' + ignoreAttr + ']').removeAttr(ignoreAttr);\n        html = html.html();\n        return html;\n    }\n\n    function token() {\n        return Math.floor(Math.random() * 1000000000).toString();\n    }\n}\n\nfunction tagName($el) {\n    // Different in DOM and Cheerio. Cheerio\n    // doesn't support prop() either.\n    return $el[0].tagName || $el[0].name;\n}\n\nexport function BookHTMLToJSON(html) {\n    var sanitizeHtml = require('sanitize-html');\n\n    var cleanHTML = sanitizeHtml(html, {\n        allowedTags: sanitizeHtml.defaults.allowedTags.concat([ 'img' ])\n    });\n\n    console.log(html);\n\n    var style = getFilteredCSS(html);\n\n    const splitHtmlResult = splitHtml(html, 'h1');\n\n    console.log(splitHtmlResult)\n\n    var chapterArray = []\n\n    // start from one because first element is always ''\n    for (let index = 1; index < splitHtmlResult.length - 1; index = index + 2) {\n\n        // structure of the array that is expected\n        // h1 chapterHtml h1 chapterHtml\n\n        // TODO: handle error cases when array is not in valid format.\n        let title_with_h1 = splitHtmlResult[index]\n        let chapter_html = splitHtmlResult[index + 1]\n\n        let root = parse(title_with_h1)\n\n        let chapter_name_text = root.querySelector('h1').text;\n\n        let chapter = {\n            \"name\" : chapter_name_text,\n            \"page\" : {\n                \"html\" : title_with_h1 + chapter_html\n            }\n        }\n        chapterArray.push(chapter);\n    }\n\n    return {\n        \"book\": {\n            \"name\": \"DEFAULT NAME\",\n            \"currentSelectedChapter\" : 0, // default chapter is 1st.\n            \"chapters\": chapterArray,\n            \"style\" : \"<style>\" + style + \"</style>\"\n        }\n    }\n}\n\nfunction getFilteredCSS(html) {\n    const doc = new DOMParser().parseFromString(html, \"text/html\");\n    const cssStr = [...doc.querySelectorAll('style')]\n        .map(style => style.textContent);\n\n    const filterCss = require('filter-css');\n\n\n    // filter the css to remove everything but font-weight information.\n    // TODO: add more filters as necessary.\n    const filtered = filterCss(cssStr[0], [/li/, /color/, /font-family/, /font-size/, /h[1-6]/, /margin/, /margin-top/, /margin-bottom/, /margin-left/, /margin-right/, /padding/, /padding-top/, /padding-bottom/, /padding-left/, /padding-right/ ]);\n\n    console.log(filtered);\n    return filtered;\n\n}"],"sourceRoot":""}