(this.webpackJsonppicasso=this.webpackJsonppicasso||[]).push([[0],{140:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var o,r=n(74),s=n(141),a=n.n(s),i=n(282);function c(e,t,n,r){n||(n=function(e){return!0});for(var s,a,i,c,l,d,u,h,p=(r=r||{}).cheerio||null,b=[],j="data-"+N(),m="data-"+N();;){for(a=(s=o.load(e,p))(t),c=null,i=0;i<a.length&&((c=a.eq(i)).attr(m)||!n(c));i++)c.attr(m,"1"),c=null;if(!c){b.push(e);break}c.attr(j,"1");var f=s.html(),O=f.indexOf(j),g=f.lastIndexOf("<",O);if(-1===g){b.push(e);break}var x=f.substr(0,g),v="";l=o.load("<div></div>")("div").eq(0);var k=c.parents();for(i=0;i<k.length;i++){var y=k.eq(i);if(y.is("[data-cheerio-root]"))break;var w=y.clone();w.empty(),l.empty(),l.append(w);var I=l.html(),S=I.indexOf(">");x+="</"+(d=(h=w)[0].tagName||h[0].name)+">",v=I.substr(0,S+1)+v}f=s.html(),l=o.load("<div></div>")("div").eq(0),c.removeAttr(j),l.append(c),d=l.html(),c.remove(),u=v+(f=s.html()).substr(g),x=R(x),b.push(x),b.push(d),e=R(u)}return b;function R(e){return(e=o.load(e,p))("["+m+"]").removeAttr(m),e=e.html()}function N(){return Math.floor(1e9*Math.random()).toString()}}function l(e){var t=n(222),o=(t(e,{allowedTags:t.defaults.allowedTags.concat(["img"])}),function(e){var t=(new DOMParser).parseFromString(e,"text/html"),o=Object(r.a)(t.querySelectorAll("style")).map((function(e){return e.textContent})),s=n(453),a=[/font-family/,/font-size/,/h[1-6]/,/margin/,/margin-top/,/margin-bottom/,/margin-left/,/margin-right/,/padding/,/padding-top/,/padding-bottom/,/padding-left/,/padding-right/,/background-color/,/line-height/,/text-align/],i=s(o[0],a);return console.log(i),i}(e)),s=c(e,"h1");console.log(s);for(var a=[],l=1;l<s.length-1;l+=2){var d=s[l],u=s[l+1],h={name:Object(i.a)(d).querySelector("h1").text,page:{html:d+u}};a.push(h)}return{book:{name:"DEFAULT NAME",currentSelectedChapter:0,chapters:a,style:"<style>"+o+"</style>"}}}"undefined"===typeof window?(e.exports=c,o=n(346)):(window.splitHtml=c,o={load:function(e){var t=a()("<div data-cheerio-root>"),n=a()(e);function o(e){return"<"===e[0]?a()(e):t.find(e)}return t.append(n),o.html=function(){return t.html()},o}})}).call(this,n(194)(e))},177:function(e,t,n){},202:function(e,t,n){},237:function(e,t){},302:function(e,t,n){},315:function(e,t,n){},345:function(e,t,n){},367:function(e,t){},421:function(e,t){},448:function(e,t){},498:function(e,t,n){},520:function(e,t,n){},521:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n(1),s=n.n(r),a=n(20),i=n.n(a),c=(n(302),n(11)),l=n(12),d=n(16),u=n(15),h=n(46),p=n(26),b=n(263),j=n.n(b),m=n(55);n(192);m.a.apps.length?m.a.app():m.a.initializeApp({apiKey:"AIzaSyDg4KHJi2J9BExIfX24bnlZtefNzvjxoMo",authDomain:"picasso-2a25e.firebaseapp.com",projectId:"picasso-2a25e",storageBucket:"picasso-2a25e.appspot.com",messagingSenderId:"473349610263",appId:"1:473349610263:web:3e3236947601122ee17552",measurementId:"G-4HV3JC920J"}),m.a.analytics();var f=m.a.firestore(),O=m.a.auth(),g=m.a.auth,x=m.a.storage().ref(),v=n(131);var k=function(){var e=Object(v.useLastLocation)();e=e?"#"+e.pathname:"#/home/";var t={signInFlow:"popup",signInOptions:[g.EmailAuthProvider.PROVIDER_ID],signInSuccessUrl:e};return null!==O.currentUser?Object(o.jsx)(p.c,{to:e}):(console.log("showing signin form"),Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{style:{visibility:"#/home/"===e?"hidden":"visible",textAlign:"center"},children:"Let's have you signed in and we'll take you to your book."}),Object(o.jsx)(j.a,{uiConfig:t,firebaseAuth:O})]}))},y=n.p+"static/media/Logo.d37141a7.svg",w=n.p+"static/media/Hero.82d2f637.svg",I=n(567),S=(n(315),n(265)),R=n.n(S),N=n(269),C=n.n(N),D=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).import=function(){o.setState({goToAddScreen:!0})},o._handleTextfieldChange=function(e){o.setState({documentLink:e.target.value})},o.state={documentLink:"",goToAddScreen:!1},o}return Object(l.a)(n,[{key:"render",value:function(){var e=this;if(this.state.goToAddScreen){var t=new RegExp("/document/d/([a-zA-Z0-9-_]+)").exec(this.state.documentLink)[1];return Object(o.jsx)(p.c,{to:"/add/"+t})}var n=Object(o.jsx)(C.a,{});return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{style:{background:"#E3F2FD",height:"600px"},children:[Object(o.jsxs)(I.a,{display:"flex",justifyContent:"center",className:"navbar",children:[Object(o.jsx)("img",{src:y})," "]}),Object(o.jsx)(I.a,{children:Object(o.jsxs)("h1",{id:"heading_line",children:["Publish beautiful, interactive textbooks",Object(o.jsx)("br",{}),"using only Google Docs."]})}),Object(o.jsx)(I.a,{display:"flex",justifyContent:"center",children:Object(o.jsx)(R.a,{value:this.state.documentLink,onChange:function(t){return e.setState({documentLink:t})},placeholder:"Your Google Doc link",searchIcon:n,closeIcon:n,style:{width:"25rem"},onRequestSearch:function(){e.import()},onCancelSearch:function(){e.import()}})}),Object(o.jsxs)(I.a,{display:"flex",justifyContent:"center",className:"navbar",children:[Object(o.jsx)("img",{src:w})," "]})]})})}}]),n}(r.Component),E=n(143),T=n(283),L=n(54),F=n(72),U=n.n(F),A=s.a.createContext();var _=function(e){var t=e.children,n=Object(r.useState)(null),s=Object(L.a)(n,2),a=s[0],i=s[1],c=Object(r.useState)(!0),l=Object(L.a)(c,2),d=l[0],u=l[1];return Object(r.useEffect)((function(){O.onAuthStateChanged((function(e){console.log(e),i(e),u(!1),function(e){if(null!==e){var t=f.collection("users").doc(e.uid);t.get().then((function(n){if(!n.exists){var o={displayName:e.displayName,booksOwned:[]};t.set(o)}})).catch((function(e){console.log("Error getting document:",e)}))}}(e)}))}),[]),d?Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(U.a,{color:"#1d85d2",type:"bars"})}):Object(o.jsx)(A.Provider,{value:{currentUser:a},children:t})},q=function(e){var t=e.component,n=Object(T.a)(e,["component"]),s=Object(r.useContext)(A).currentUser;return console.log(s),Object(o.jsx)(p.d,Object(E.a)(Object(E.a)({},n),{},{render:function(e){return s?Object(o.jsx)(t,Object(E.a)({},e)):Object(o.jsx)(p.c,{to:{pathname:"/signin/"}})}}))},B=n(25),P=(n(345),n(202),n.p+"static/media/logo.f5577065.svg"),M=n(196),H=n.p+"static/media/bookmark_border.7ab6e61e.svg",Q=n.p+"static/media/note_add.deaa3c98.svg",J=n.p+"static/media/search.c49eb908.svg",z=n.p+"static/media/volume_up.f92f4a65.svg",G=n(270),W=n.n(G),K=n(140);function Y(e){if(null!==e){console.log(e);var t="https://docs.google.com/feeds/download/documents/export/Export?id="+e+"&exportFormat=html";console.log(t),fetch(t).then((function(e){return e.text()})).then((function(t){!function(e,t){var n=Object(K.a)(e);console.log(n),function(e,t){var n=x.child("/books/"+t+".json"),o=JSON.stringify(e),r=new Blob([o],{type:"application/json"});n.put(r).then((function(e){console.log("Uploaded ",t,".json"),window.location.reload()}))}(n,t)}(t,e)})).catch(console.log)}}function V(){var e=new URL(window.location.href),t=e.hash.split("/")[2];console.log(e.hash),Y(t)}var X=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(o.jsxs)("div",{className:"navbar_controls",children:[Object(o.jsx)(M.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:z,alt:"play audio button",onClick:function(e){e.preventDefault(),console.log("The link was clicked.")}})}),Object(o.jsx)(M.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:H,alt:"bookmark button"})}),Object(o.jsx)(M.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:Q,alt:"add note button"})}),Object(o.jsx)(M.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:J,alt:"search button"})}),Object(o.jsx)(M.a,{"aria-label":"upload picture",component:"span",onClick:V,children:Object(o.jsx)(W.a,{})})]})}}]),n}(r.Component),Z=n(568),$=n(556),ee=n(557),te=n(558),ne=n(559),oe=n(555),re=n(144),se=n(554),ae=n(273),ie=n.n(ae),ce=n(271),le=n(274),de=n.n(le),ue=n(272),he=n.n(ue),pe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleClickOutside=function(t){e.props.outsideClickHandler(t)},e.logout=function(){console.log("Logout"),O.signOut()},e}return Object(l.a)(n,[{key:"render",value:function(){return this.props.show?Object(o.jsx)("div",{style:{minWidth:"15rem",position:"fixed",top:"0",right:"0",margin:"5.5rem 2.8rem"},children:Object(o.jsxs)(se.a,{children:[Object(o.jsxs)(re.a,{variant:"h6",align:"center",style:{marginTop:"1rem"},children:["Hi, ",O.currentUser.displayName||null,"!"]}),Object(o.jsx)(oe.a,{}),Object(o.jsxs)($.a,{component:"nav","aria-label":"main mailbox folders",children:[Object(o.jsx)(ee.a,{button:!0,onClick:this.import,children:Object(o.jsxs)(h.Link,{to:"/add",style:{display:"flex",textDecoration:"none",color:"black"},children:[Object(o.jsx)(te.a,{children:Object(o.jsx)(he.a,{})}),Object(o.jsx)(ne.a,{primary:"Import"})]})}),Object(o.jsxs)(ee.a,{button:!0,children:[Object(o.jsx)(te.a,{children:Object(o.jsx)(ie.a,{})}),Object(o.jsx)(ne.a,{primary:"Dashboard"})]}),Object(o.jsxs)(ee.a,{button:!0,onClick:this.logout,children:[Object(o.jsx)(te.a,{children:Object(o.jsx)(de.a,{})}),Object(o.jsx)(ne.a,{primary:"Logout"})]})]})]})}):null}}]),n}(r.Component),be=Object(ce.a)(pe),je=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).preventDragHandler=function(e){e.preventDefault()},o.avatarClicked=function(){console.log("Avatar clicked."),o.setState({showAccountInformation:!o.state.showAccountInformation})},o.clickedOutsideHandler=function(e){"avatar_btn"!==e.target.id&&(console.log("clicked outside",e),o.setState({showAccountInformation:!1}))},o.state={showAccountInformation:!1},o}return Object(l.a)(n,[{key:"render",value:function(){var e=O.currentUser.displayName||"";return Object(o.jsxs)("div",{onDragStart:this.preventDragHandler,children:[Object(o.jsxs)("div",{className:"navbar",children:[Object(o.jsx)("img",{src:P,height:"50rem",alt:"company logo"}),Object(o.jsx)(X,{}),Object(o.jsx)(M.a,{onClick:this.avatarClicked,children:Object(o.jsx)(Z.a,{className:"avatar",id:"avatar_btn",children:e.charAt(0).toUpperCase()||null})})]}),Object(o.jsx)(be,{show:this.state.showAccountInformation,outsideClickHandler:this.clickedOutsideHandler})]})}}]),n}(r.Component),me=n(87),fe=(n.p,n(560)),Oe=n(10),ge=n(569),xe=n(570),ve=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.book.chapters,r=[],s=Object(Oe.a)({root:{borderRadius:"0",fontSize:"1rem",fontWeight:"400",padding:"0",borderBottomRightRadius:"3rem",borderTopRightRadius:"3rem"},label:{textTransform:"none"}})(fe.a),a=Object(me.a)(n.entries());try{var i=function(){var n=Object(L.a)(e.value,2),a=n[0],i=n[1];r.push(Object(o.jsx)(s,{onClick:function(){return t.props.handler(a)},children:Object(o.jsx)(ke,{name:i.name,isBookmarked:i.isBookmarked,isSelected:a===t.props.currentSelectedChapter,index:a})},a))};for(a.s();!(e=a.n()).done;)i()}catch(c){a.e(c)}finally{a.f()}return Object(o.jsx)("div",{style:{marginTop:"3rem",display:"inline-flex",flexDirection:"column",position:"fixed",height:"82vh",overflow:"auto","overflow-x":"hidden"},children:r})}}]),n}(r.Component),ke=function(e){e.isBookmarked;var t=e.name.trim(),n=e.isSelected,r={width:"13rem",height:"3.5rem",paddingLeft:"1.5rem",paddingRight:"1rem",display:"inline-flex",alignItems:"center",backgroundColor:n?"#E3F2FD":"",borderBottomRightRadius:"3rem",borderTopRightRadius:"3rem",color:n?"#2196F3":"black",fontWeight:"500"},s=Object(Oe.a)((function(e){return{tooltip:{fontSize:e.typography.pxToRem(12)}}}))(ge.a),a={marginRight:"0.5rem",color:n?"white":"black",backgroundColor:n?"#2196F3":""};return Object(o.jsx)(s,{title:t,arrow:!0,placement:"right",children:Object(o.jsxs)("div",{style:r,children:[Object(o.jsx)(xe.a,{size:"small",label:e.index+1,style:a,variant:n?"default":"outlined"}),Object(o.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t})]})})},ye=n(106),we=n.n(ye),Ie=n(276),Se=n.n(Ie),Re=(n(498),n(277)),Ne=n.n(Re),Ce=n(565),De=n(43),Ee=(n(177),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).saveResponse=function(){""!=o.state.response?(o.saveToFirebase(),o.setState({hasResponded:!0})):console.log("BLANK")},o.onEdit=function(){o.setState({oldResponse:o.state.response}),o.setState({hasResponded:!1})},o.onChangeResponse=function(e){console.log("onChangeResponse"),o.setState({response:e.target.value})},o.loadFirebaseResponse=function(){var e=f.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","RESPONSE_QUESTION");var t=Object(B.a)(o);e.get().then((function(e){e.forEach((function(e){t.setState({response:e.data().response}),t.setState({hasResponded:!0}),t.setState({dirty:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.saveToFirebase=function(){var e=!1,t=f.collection("answers");t=(t=(t=(t=(t=t.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","RESPONSE_QUESTION");var n=Object(B.a)(o);t.get().then((function(o){n.setState({dirty:!0}),o.forEach((function(t){t.ref.update({response:n.state.response}),e=!0})),e?console.log("Response updated"):t=f.collection("answers").add({studentID:O.currentUser.uid,chapterNumber:parseInt(n.props.chapterNumber),questionNumber:parseInt(n.props.questionNumber),response:n.state.response,bookID:n.props.bookID,type:"RESPONSE_QUESTION"}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.cancelEdit=function(){o.setState({response:o.state.oldResponse}),o.setState({hasResponded:!0})},o.state={hasResponded:!1,response:"",oldResponse:"",needsFirebaseLoading:!0,dirty:!1},o}return Object(l.a)(n,[{key:"render",value:function(){this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.props.questionText,t=Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e[1].trim()})}),Object(o.jsx)(Ce.a,{style:{width:"100%",marginBottom:"1rem",marginTop:"1rem"},label:"Response",multiline:!0,onChange:this.onChangeResponse,defaultValue:this.state.response}),Object(o.jsxs)("div",{children:[Object(o.jsx)(fe.a,{variant:"contained",color:"primary",style:{float:"right"},onClick:this.saveResponse,children:"RESPOND"}),Object(o.jsx)(fe.a,{variant:"contained",color:"delete",style:{float:"right",marginRight:"1rem",visibility:this.state.dirty?"visible":"hidden"},onClick:this.cancelEdit,children:"Cancel"})]})]})}),n=Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e[1].trim()})}),Object(o.jsx)(oe.a,{}),Object(o.jsx)("p",{className:"p-no-margin",children:this.state.response}),Object(o.jsx)("div",{style:{float:"right"},children:Object(o.jsx)(fe.a,{variant:"contained",onClick:this.onEdit,children:"EDIT"})})]})});return this.state.hasResponded?n:t}}]),n}(r.Component)),Te=n(278),Le=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).saveResponse=function(e){""!==e?o.saveToFirebase(e):console.log("BLANK")},o.onEdit=function(){o.setState({oldResponse:o.state.response}),o.setState({hasResponded:!1})},o.onChangeResponse=function(e){console.log("onChangeResponse",e),o.setState({response:e}),o.saveResponse(e)},o.loadFirebaseResponse=function(){var e=f.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","TRUE_OR_FALSE");var t=Object(B.a)(o);e.get().then((function(e){e.forEach((function(e){if("TRUE_OR_FALSE"!==e.data().type)return console.log("ERROR, QUESTION TYPE MISMATCH"),void t.setState({error:!0});t.setState({response:e.data().response}),t.setState({hasResponded:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.saveToFirebase=function(e){var t=!1,n=f.collection("answers");n=(n=(n=(n=(n=n.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","TRUE_OR_FALSE");var r=Object(B.a)(o);n.get().then((function(o){o.forEach((function(n){n.ref.update({response:e}),t=!0})),t?console.log("Response updated"):n=f.collection("answers").add({studentID:O.currentUser.uid,chapterNumber:parseInt(r.props.chapterNumber),questionNumber:parseInt(r.props.questionNumber),response:e,type:"TRUE_OR_FALSE",bookID:r.props.bookID}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.cancelEdit=function(){o.setState({response:o.state.oldResponse}),o.setState({hasResponded:!0})},o.state={hasResponded:!1,response:"",needsFirebaseLoading:!0,error:!1},o}return Object(l.a)(n,[{key:"render",value:function(){if(this.state.error)return Object(o.jsx)("div",{children:"ERROR RENDERING QUESTION. Please contact us."});this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.props.questionText,t=e[1].split(">")[0].trim(),n=e[1].split(">")[1].trim().toUpperCase();return this.state.hasResponded?Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:t})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsxs)(De.RadioGroup,{onChange:this.onChangeResponse,value:this.state.response,horizontal:!0,children:[Object(o.jsx)(De.RadioButton,{value:"TRUE",rootColor:"black",pointColor:"TRUE"===n?"green":"red",children:Object(o.jsx)("b",{children:"TRUE"})}),Object(o.jsx)(De.RadioButton,{value:"FALSE",rootColor:"black",pointColor:"FALSE"===n?"green":"red",children:Object(o.jsx)("b",{children:"FALSE"})})]})})]})}):Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:t})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsxs)(De.RadioGroup,{onChange:this.onChangeResponse,horizontal:!0,children:[Object(o.jsx)(De.RadioButton,{value:"TRUE",rootColor:"black",pointColor:"TRUE"===n?"green":"red",children:Object(o.jsx)("b",{children:"TRUE"})}),Object(o.jsx)(De.RadioButton,{value:"FALSE",rootColor:"black",pointColor:"FALSE"===n?"green":"red",children:Object(o.jsx)("b",{children:"FALSE"})})]})})]})})}}]),n}(r.Component),Fe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).saveResponse=function(e){""!==e?r.saveToFirebase(e):console.log("BLANK")},r.onEdit=function(){r.setState({oldResponse:r.state.response}),r.setState({hasResponded:!1})},r.onChangeResponse=function(e){console.log("onChangeResponse",e),r.setState({response:e}),r.saveResponse(e)},r.loadFirebaseResponse=function(){var e=f.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(r.props.chapterNumber))).where("questionNumber","==",parseInt(r.props.questionNumber))).where("bookID","==",r.props.bookID)).where("type","==","MULTIPLE_CHOICE");var t=Object(B.a)(r);e.get().then((function(e){e.forEach((function(e){if("MULTIPLE_CHOICE"!==e.data().type)return console.log("ERROR, QUESTION TYPE MISMATCH"),void t.setState({error:!0});t.setState({response:e.data().response}),t.setState({hasResponded:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},r.saveToFirebase=function(e){var t=!1,n=f.collection("answers");n=(n=(n=(n=(n=n.where("studentID","==",O.currentUser.uid)).where("chapterNumber","==",parseInt(r.props.chapterNumber))).where("questionNumber","==",parseInt(r.props.questionNumber))).where("bookID","==",r.props.bookID)).where("type","==","MULTIPLE_CHOICE");var o=Object(B.a)(r);n.get().then((function(r){r.forEach((function(n){n.ref.update({response:e}),t=!0})),t?console.log("Response updated"):n=f.collection("answers").add({studentID:O.currentUser.uid,chapterNumber:parseInt(o.props.chapterNumber),questionNumber:parseInt(o.props.questionNumber),response:e,type:"MULTIPLE_CHOICE",bookID:o.props.bookID}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))};var s,a=r.props.questionText,i=a[1].split(">")[0].trim(),l=a[1].split(">").slice(1,a[1].split(">").length-1),d=parseInt(a[1].split(">")[a[1].split(">").length-1].trim()),u=[],h=Object(me.a)(l.entries());try{for(h.s();!(s=h.n()).done;){var p=Object(L.a)(s.value,2),b=p[0],j=p[1];u.push(Object(o.jsxs)(De.RadioButton,{value:b+1,rootColor:"black",pointColor:d===b+1?"green":"red",children:[" ",j.trim()," "]},b))}}catch(m){h.e(m)}finally{h.f()}return r.state={hasResponded:!1,response:"",needsFirebaseLoading:!0,error:!1,question:i,items:u,choicesArray:l},r}return Object(l.a)(n,[{key:"render",value:function(){if(this.state.error)return Object(o.jsx)("div",{children:"ERROR RENDERING QUESTION. Please contact us."});this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.state.question,t=this.state.items;return this.state.hasResponded?Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsx)(De.RadioGroup,{onChange:this.onChangeResponse,value:this.state.response,vertical:!0,children:t.map((function(e){return e}))})})]})}):Object(o.jsx)(I.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsx)(De.RadioGroup,{onChange:this.onChangeResponse,vertical:!0,children:t.map((function(e){return e}))})})]})})}}]),n}(r.Component),Ue=(new Ne.a,n(222),null),Ae=null,_e=null;function qe(e,t){if(null===e)return!1;if(void 0===e.children)return!1;for(var n=0;n<e.children.length;n++){if(e.children[n].name===t)return!0;if(!0===qe(e.children[n],t))return!0}return!1}function Be(e,t){if("tag"===e.type&&e.name.startsWith("h")&&!Me(e,String()).trim())return null;if("tag"===e.type&&"img"===e.name)return console.log("IMG FOUND"),Object(o.jsx)("img",{src:e.attribs.src,className:"chapter_img",alt:"chapter_img"});if("tag"===e.type&&"span"===e.name)return console.log("SPAN FOUND",e),e.attribs.style=null,Object(ye.convertNodeToElement)(e,t,Be);if("tag"===e.type&&"p"===e.name){console.log("P FOUND",e);var n=Me(e,String());if(console.log(qe(e,"img")),!n.trim()&&!qe(e,"img"))return null;if(n.startsWith("RESPONSE_QUESTION")){var r=n.split(":");return Object(o.jsx)(Ee,{questionNumber:Ae++,chapterNumber:Ue,questionText:r,bookID:_e})}if(n.startsWith("TRUE_OR_FALSE")){var s=n.split(":");return Object(o.jsx)(Le,{questionNumber:Ae++,chapterNumber:Ue,questionText:s,bookID:_e})}if(n.startsWith("MULTIPLE_CHOICE")){var a=n.split(":");return Object(o.jsx)(Fe,{questionNumber:Ae++,chapterNumber:Ue,questionText:a,bookID:_e})}return"tag"===e.type&&"a"===e.name?(e.attribs.target="_blank",Object(ye.convertNodeToElement)(e,t,Be)):n.startsWith("VIDEO_LINK")?Object(o.jsx)(I.a,{display:"flex",justifyContent:"center",children:Object(o.jsx)(Se.a,{url:Pe(n)})}):Object(ye.convertNodeToElement)(e,t,Be)}}function Pe(e){return e.replace(/(https?:\/\/[^\s]+)/g,(function(e){return e}))}function Me(e,t){if("text"===e.type)return e.data;for(var n in e.children){var o=t.concat(Me(e.children[n],String()));t=o}return t}var He=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).updateChapterNumberAndResetQuestionID(e.chapterNumber),_e=o.props.bookID,console.log(e.html),o}return Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.updateChapterNumberAndResetQuestionID(e.chapterNumber)}},{key:"updateChapterNumberAndResetQuestionID",value:function(e){Ae=1,Ue=e}},{key:"render",value:function(){console.log("Chapter Number",Ue),console.log("STYLE ",this.props.style);var e="<html>"+this.props.style+this.props.html+"</html>";return Object(o.jsxs)("div",{style:{width:"55%",margin:"0 auto"},children:[we()(e,{transform:Be}),Object(o.jsx)(Te.a.Embed,{websiteId:2736,id:this.props.bookID+"CHAPTER"+Ue},Ue)]})}}]),n}(r.Component),Qe=n(279),Je=n.n(Qe),ze=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).downloadJSON=function(e){var t=x.child("books/"+e+".json"),n=Object(B.a)(o);t.getDownloadURL().then((function(e){console.log("Downloading...");var t=new XMLHttpRequest;t.responseType="blob",t.onload=function(e){t.response.text().then((function(e){n.setState({bookJSON:JSON.parse(e),downloadSuccessful:!0})}))},t.withCredentials=!1,t.open("GET",e),t.send()})).catch((function(e){e.code}))},o.onSidebarClick=function(e){window.scrollTo(0,0),o.updateJsonInFirebase(),o.setState({currentChapter:e})},o.updateJsonInFirebase=function(){console.log("TODO: Implement firebase JSON update.")},o.state={downloadSuccessful:!1,currentChapter:0,bookID:o.props.match.params.bookID,bookJSON:null},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.downloadJSON(this.state.bookID),console.log("BOOK ID",this.state.bookID)}},{key:"render",value:function(){if(this.state.downloadSuccessful){var e=this.state.bookJSON;return console.log(e),Object(o.jsxs)("div",{children:[Object(o.jsx)(Je.a,{height:"4px",bgcolor:"#1d85d2"}),Object(o.jsx)(je,{}),Object(o.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(o.jsx)(ve,{handler:this.onSidebarClick,currentSelectedChapter:this.state.currentChapter,book:e.book}),Object(o.jsx)(He,{html:e.book.chapters[this.state.currentChapter].page.html,style:e.book.style,chapterNumber:this.state.currentChapter,bookID:this.state.bookID})]})]})}return Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(U.a,{color:"#1d85d2",type:"bars"})})}}]),n}(r.Component),Ge=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).import=function(){if(""!==o.state.documentLink){var e=new RegExp("/document/d/([a-zA-Z0-9-_]+)").exec(o.state.documentLink)[1];console.log(e),o.setState({bookID:e,pending:!0});var t="https://docs.google.com/feeds/download/documents/export/Export?id="+e+"&exportFormat=html";console.log(t),fetch(t).then((function(e){return e.text()})).then((function(e){o.conversion(e)})).catch(console.log)}},o.conversion=function(e){var t=Object(K.a)(e);console.log(t),o.upload(t)},o.upload=function(e){var t=x.child("/books/"+o.state.bookID+".json"),n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),s=Object(B.a)(o);t.put(r).then((function(e){console.log("Uploaded ",s.state.bookID,".json"),s.setState({importSuccessful:!0,pending:!1})}));var a=f.collection("books").doc(o.state.bookID.toString());a.get().then((function(e){e.exists||a.set({title:"How to be a Software Engineer",author:"Sahas",author_uid:O.currentUser.uid,price:0,summary:"Summary of the book!"}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))}))},o._handleTextfieldChange=function(e){o.setState({documentLink:e.target.value})},o.state={importSuccessful:!1,bookID:"",documentLink:"",pending:!1},console.log(o.props.match.params.bookID),o}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return console.log("PROPS",this.props),this.props.match&&console.log(this.props.match.params.bookID),this.state.importSuccessful?Object(o.jsx)(p.c,{to:"../read/"+this.state.bookID}):this.state.pending?Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(U.a,{color:"#1d85d2",type:"bars"})}):this.props.match.params.bookID?(this.setState({documentLink:"https://docs.google.com/document/d/"+this.props.match.params.bookID}),this.import(),Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(U.a,{color:"#1d85d2",type:"bars"})})):Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{style:{textAlign:"center"},children:"What's your Google Doc link?"}),Object(o.jsxs)(I.a,{display:"flex",justifyContent:"center",children:[Object(o.jsx)(Ce.a,{id:"outlined-basic",placeholder:"https://docs.google.com/document/...",variant:"outlined",style:{width:"40rem"},onChange:this._handleTextfieldChange}),Object(o.jsx)(fe.a,{type:"submit",color:"primary",onClick:function(){e.import()},children:"IMPORT"})]})]})}}]),n}(s.a.Component),We=n(562),Ke=n(564),Ye=n(563),Ve=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).getBookMetaData=function(e){var t=f.collection("books").doc(e),n=Object(B.a)(o);t.get().then((function(e){e.exists?(console.log("Document data:",e.data()),n.setState({bookMetaData:e.data(),isStillLoading:!1})):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},o.state={bookMetaData:null,isStillLoading:!0,needsFirebaseLoading:!0},o}return Object(l.a)(n,[{key:"render",value:function(){var e=this;this.state.needsFirebaseLoading&&(this.getBookMetaData(this.props.bookID),this.setState({needsFirebaseLoading:!1}));return this.state.isStillLoading?Object(o.jsx)("div",{}):Object(o.jsxs)(se.a,{style:{maxWidth:345},children:[Object(o.jsxs)(We.a,{children:[Object(o.jsx)(Ye.a,{style:{height:200},image:"https://markmanson.net/wp-content/uploads/2020/03/subtle-art-everything-is-fcked-combo.jpg",title:this.state.bookMetaData.title}),Object(o.jsxs)(Ke.a,{children:[Object(o.jsx)(re.a,{gutterBottom:!0,variant:"h5",children:this.state.bookMetaData.title}),Object(o.jsx)(re.a,{variant:"body2",color:"textSecondary",component:"p",children:this.state.bookMetaData.summary})]})]}),Object(o.jsx)(I.a,{display:"flex",alignItems:"center",justifyContent:"space-between",style:{padding:"10px"},children:Object(o.jsx)(fe.a,{size:"small",color:"primary",onClick:function(){return e.props.handler(e.props.bookID)},children:"Get this book"})})]})}}]),n}(s.a.Component),Xe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).getBookList=function(){var e=Object(B.a)(o);f.collection("books").get().then((function(t){var n=[];t.forEach((function(e){n.push(e.id)})),e.setState({listOfBookIds:n})}))},o.handler=function(e){console.log(e),o.setState({redirect:!0,bookIDChosen:e})},o.state={needToFetch:!0,listOfBookIds:[],redirect:!1,bookIDChosen:null},o}return Object(l.a)(n,[{key:"render",value:function(){if(this.state.redirect)return Object(o.jsx)(p.c,{to:"/book/buy/"+this.state.bookIDChosen});this.state.needToFetch&&(this.getBookList(),this.setState({needToFetch:!1}));var e=[];for(var t in this.state.listOfBookIds)console.log(this.state.listOfBookIds[t]),e.push(Object(o.jsx)(Ve,{bookID:this.state.listOfBookIds[t],handler:this.handler}));return console.log(e),Object(o.jsx)(I.a,{style:{margin:"4rem"},display:"flex",children:e})}}]),n}(r.Component),Ze=n(90),$e=n.n(Ze),et=n(184),tt=n(280),nt=n(281),ot=(n(520),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).handleClick=function(){var e=Object(et.a)($e.a.mark((function e(t){var n;return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.setState({sendState:"loading"}),n=Object(B.a)(o),e.next=4,f.collection("customers").doc(O.currentUser.uid).collection("checkout_sessions").add({price:"price_1IFnjRI7w6vzg9yGEqXngtjl",success_url:window.location.origin+"/picasso/#/read/"+n.props.bookID,cancel_url:window.location.origin+"/picasso/#/paymentFailed/"});case 4:e.sent.onSnapshot(function(){var e=Object(et.a)($e.a.mark((function e(t){var n,r,s,a;return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data(),r=n.error,s=n.sessionId,r&&alert("An error occured: ".concat(r.message)),!s){e.next=8;break}return e.next=5,Object(tt.a)("pk_live_51I206fI7w6vzg9yGXHSlq83Uc5cTj9TlQhMiDw6JRLPiJN2wVxm8HxYv0DRzaN7Fm4uNQpCrP9QAPBlzpMxvbDHz004Lmwr0m2");case 5:a=e.sent,o.setState({sendState:""}),a.redirectToCheckout({sessionId:s});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o.state={sendState:""},o}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=function(t){var n=t.handleClick;return Object(o.jsx)("section",{children:Object(o.jsxs)(I.a,{display:"flex",className:"product",children:[Object(o.jsx)("img",{src:"https://i.imgur.com/iAAICpQ.png",className:"bookCover"}),Object(o.jsxs)("div",{className:"description",children:[Object(o.jsx)("h3",{id:"bookTitle",children:"From Idea to Operations"}),Object(o.jsxs)("p",{children:[Object(o.jsx)("i",{children:"by"})," Shane Snipes PhD"," "]}),Object(o.jsx)("p",{children:"This book is designed to show you how to run a business through practicing the skills of operating one, whether you have an idea or are currently running an organization. If you do not have an idea, that is okay too. You will develop one in a chapter coming up. This book is built on that premise you must unlearn what you think business is; built on my research completed since 2017, on mindfulness. You must let go of the idea that learning lots of skills will add up to entrepreneurship."}),Object(o.jsx)("h5",{id:"price",children:"$20.00/month"}),Object(o.jsx)(nt.Beetle,{color:"primary",variant:"contained",onClick:n,state:e.state.sendState,children:"Pay now"})]})]})})};return Object(o.jsx)(t,{handleClick:this.handleClick})}}]),n}(s.a.Component)),rt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).fetchDetails=function(){var e=f.collection("books").doc(o.state.bookID),t=Object(B.a)(o);e.get().then((function(e){e.exists?(console.log("Document data:",e.data()),t.setState({bookData:e.data()})):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))},o.state={bookID:o.props.match?o.props.match.params.bookID:null,bookData:null,needsFetching:!0},o}return Object(l.a)(n,[{key:"render",value:function(){return this.state.needsFetching&&(this.fetchDetails(),this.setState({needsFetching:!1})),Object(o.jsx)(ot,{bookID:this.props.match.params.bookID})}}]),n}(s.a.Component),st=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(o.jsxs)("div",{children:["We're not sure what happened but that didn't work. That's all we know. Go to ",Object(o.jsx)("a",{href:"/picasso/",children:"Home"})]})}}]),n}(s.a.Component),at=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return console.log("In the router."),Object(o.jsx)(h.HashRouter,{basename:"/",children:Object(o.jsx)(v.LastLocationProvider,{children:Object(o.jsxs)(p.g,{children:[Object(o.jsx)(p.d,{path:"/signin/",children:Object(o.jsx)(k,{})}),")}/>",Object(o.jsx)(p.d,{path:"/home/",exact:!0,component:D}),Object(o.jsx)(q,{path:"/marketplace/",exact:!0,component:Xe}),Object(o.jsx)(q,{path:"/paymentFailed/",exact:!0,component:st}),Object(o.jsx)(q,{path:"/book/buy/:bookID",exact:!0,component:rt}),Object(o.jsx)(q,{path:"/read/:bookID",exact:!0,component:ze}),Object(o.jsx)(q,{path:"/add/",exact:!0,component:Ge}),Object(o.jsx)(q,{path:"/add/:bookID",exact:!0,component:Ge}),Object(o.jsx)(p.d,{path:"*",children:Object(o.jsx)(p.c,{to:"/home/"})})]})})})}}]),n}(s.a.Component);console.log("index.js called."),i.a.render(Object(o.jsx)(s.a.StrictMode,{children:Object(o.jsx)(_,{children:Object(o.jsx)(at,{})})}),document.getElementById("root"))}},[[521,1,2]]]);
//# sourceMappingURL=main.6b3e6846.chunk.js.map