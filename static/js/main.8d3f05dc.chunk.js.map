{"version":3,"sources":["utils/BookHTMLToJSONBuilder.js","config/firebase.js","Login/SignIn.js","Textbook/Components/Navbar/svg/logo.svg","Textbook/Components/Navbar/svg/bookmark_border.svg","Textbook/Components/Navbar/svg/note_add.svg","Textbook/Components/Navbar/svg/search.svg","Textbook/Components/Navbar/svg/volume_up.svg","utils/refresh.js","Textbook/Components/Navbar/Controls.js","Textbook/Components/Navbar/Account/AccountInformation.js","Textbook/Components/Navbar/NavBar.js","Textbook/Components/SideBar/svg/bookmark_border.svg","Textbook/Components/SideBar/SideBar.js","Textbook/Components/Chapter/Question/ResponseQuestion.js","Textbook/Components/Chapter/Question/TrueFalseQuestion.js","Textbook/Components/Chapter/Question/MultipleChoiceQuestion.js","Textbook/Components/Chapter/Chapter.js","Textbook/TextBookViewer.js","Auth.js","PrivateRoute.js","AddBook/AddBookScreen.js","index.js"],"names":["cheerio","splitHtml","html","splitOn","test","opts","$el","$","$matches","i","$match","$wrapper","tag","second","cheerioOpts","result","splitAttr","token","ignoreAttr","load","length","eq","attr","push","markup","splitAt","indexOf","leftAt","lastIndexOf","first","substr","reopen","$parents","parents","$original","is","$parent","clone","empty","append","parentMarkup","endTagAt","tagName","name","removeAttr","remove","cleanup","Math","floor","random","toString","BookHTMLToJSON","sanitizeHtml","require","allowedTags","defaults","concat","console","log","style","doc","DOMParser","parseFromString","cssStr","querySelectorAll","map","textContent","filtered","filterCss","getFilteredCSS","splitHtmlResult","chapterArray","index","title_with_h1","chapter_html","chapter","parse","querySelector","text","window","module","exports","jQuery","c","s","find","firebase","apps","app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","analytics","f_db","firestore","f_auth","auth","f_storage_ref","storage","ref","uiConfig","signInFlow","signInSuccessUrl","signInOptions","EmailAuthProvider","PROVIDER_ID","SignInScreen","firebaseAuth","bring_it_in","docId","url","fetch","then","response","contents","docID","json","newBookRef","child","jsonString","JSON","stringify","blob","Blob","type","put","snapshot","location","reload","upload","conversion","catch","refresh","URL","href","hash","split","Controls","className","IconButton","color","aria-label","component","src","Audio","alt","onClick","e","preventDefault","BookMark","AddNote","Search","Component","AccountInformation","handleClickOutside","evt","props","outsideClickHandler","logout","signOut","this","show","minWidth","position","top","right","margin","Card","Typography","variant","align","marginTop","currentUser","displayName","Divider","List","ListItem","button","import","to","display","textDecoration","ListItemIcon","ListItemText","primary","onClickOutside","NavBar","preventDragHandler","avatarClicked","setState","showAccountInformation","state","clickedOutsideHandler","target","id","onDragStart","Logo","height","Avatar","charAt","toUpperCase","SideBar","chapterList","book","chapters","SideBarElementList","StyledButton","withStyles","root","borderRadius","fontSize","fontWeight","padding","borderBottomRightRadius","borderTopRightRadius","label","textTransform","Button","entries","handler","SideBarElement","isBookmarked","isSelected","currentSelectedChapter","flexDirection","trim","width","paddingLeft","paddingRight","alignItems","backgroundColor","HtmlTooltip","theme","tooltip","typography","pxToRem","Tooltip","chipStyle","marginRight","title","arrow","placement","Chip","size","overflow","textOverflow","whiteSpace","ResponseQuestion","saveResponse","saveToFirebase","hasResponded","onEdit","oldResponse","onChangeResponse","value","loadFirebaseResponse","query","collection","where","uid","parseInt","chapterNumber","questionNumber","bookID","referenceToOldThis","get","querySnapshot","forEach","data","dirty","error","responseAlreadyExists","update","add","studentID","docRef","cancelEdit","needsFirebaseLoading","questionText","responseQuestion","Box","boxShadow","TextField","marginBottom","multiline","onChange","defaultValue","float","visibility","responseQuestionRespondedView","TrueFalseQuestion","question","correctAnswer","borderWidth","horizontal","rootColor","pointColor","MultipleChoiceQuestion","choicesArray","slice","items","vertical","item","currentChapter","HashMap","newQuestionId","contains","node","undefined","children","transform","startsWith","getText","String","attribs","convertNodeToElement","justifyContent","urlify","replace","str","temp","Chapter","updateChapterNumberAndResetQuestionID","nextProps","ReactHtmlParser","Embed","websiteId","TextBookViewer","downloadJSON","bookRef","that","getDownloadURL","xhr","XMLHttpRequest","responseType","onload","event","bookJSON","downloadSuccessful","open","send","code","onSidebarClick","updateJsonInFirebase","match","params","bookJSONObject","bgcolor","page","left","AuthContext","React","createContext","AuthProvider","useState","setCurrentUser","pending","setPending","useEffect","onAuthStateChanged","user","Provider","PrivateRoute","RouteComponent","rest","useContext","render","routeProps","AddBookScreen","documentLink","RegExp","exec","importSuccessful","_handleTextfieldChange","textAlign","placeholder","ReactDOM","StrictMode","basename","path","SignIn","exact","document","getElementById"],"mappings":"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","file":"static/js/main.8d3f05dc.chunk.js","sourcesContent":["// take the HTML from Google doc API\n// Split it into Chapters and build the sample_book.json.\n\nimport jQuery from 'jquery';\nimport { parse } from 'node-html-parser';\n\nvar cheerio;\n\nif (typeof window === 'undefined') {\n    // node\n    module.exports = splitHtml;\n    cheerio = require('cheerio');\n} else {\n    window.splitHtml = splitHtml;\n    // In the browser, use actual jQuery in place of Cheerio.\n    // Create a simulated cheerio object.\n    cheerio = {\n        load: function(html) {\n            var $wrapper = jQuery('<div data-cheerio-root>');\n            var $el = jQuery(html);\n            $wrapper.append($el);\n            function c(s) {\n                if (s[0] === '<') {\n                    return jQuery(s);\n                }\n                return $wrapper.find(s);\n            }\n            c.html = function() {\n                return $wrapper.html();\n            };\n            return c;\n        },\n    };\n}\n\nfunction splitHtml(html, splitOn, test, opts) {\n    if (!test) {\n        test = function($el) {\n            return true;\n        };\n    }\n    opts = opts || {};\n    var cheerioOpts = opts.cheerio || null;\n    var result = [];\n    var splitAttr = 'data-' + token();\n    var ignoreAttr = 'data-' + token();\n    var $;\n    var $matches;\n    var i;\n    var $match;\n    var $wrapper;\n    var tag;\n    var second;\n    while (true) {\n        $ = cheerio.load(html, cheerioOpts);\n        $matches = $(splitOn);\n        $match = null;\n        for (i = 0; (i < $matches.length); i++) {\n            $match = $matches.eq(i);\n            if ((!$match.attr(ignoreAttr)) && test($match)) {\n                break;\n            } else {\n                $match.attr(ignoreAttr, '1');\n            }\n            $match = null;\n        }\n        if (!$match) {\n            result.push(html);\n            break;\n        }\n        $match.attr(splitAttr, '1');\n        var markup = $.html();\n        var splitAt = markup.indexOf(splitAttr);\n        var leftAt = markup.lastIndexOf('<', splitAt);\n        if (leftAt === -1) {\n            result.push(html);\n            break;\n        }\n        var first = markup.substr(0, leftAt);\n\n        // For the second segment we need to reopen the\n        // open tags from the first segment. Reconstruct that.\n\n        var reopen = '';\n        $wrapper = cheerio.load('<div></div>')('div').eq(0);\n        var $parents = $match.parents();\n        for (i = 0; (i < $parents.length); i++) {\n            var $original = $parents.eq(i);\n            if ($original.is('[data-cheerio-root]')) {\n                // Simulated cheerio used in browser has\n                // a wrapper element\n                break;\n            }\n            var $parent = $original.clone();\n            $parent.empty();\n            $wrapper.empty();\n            $wrapper.append($parent);\n            var parentMarkup = $wrapper.html();\n            var endTagAt = parentMarkup.indexOf('>');\n            tag = tagName($parent);\n            // Cheerio tolerates missing closing tags,\n            // but real jQuery will discard any text\n            // preceding them, so play nice\n            first += '</' + tag + '>';\n            reopen = parentMarkup.substr(0, endTagAt + 1) + reopen;\n        }\n\n        // We can't just split off the next fragment at\n        // > because the matching tag may be a container.\n        // Move it to a wrapper to get its full markup,\n        // then remove it from the original document. The\n        // remainder of the original document now begins\n        // where the matching tag used to\n\n        markup = $.html();\n\n        $wrapper = cheerio.load('<div></div>')('div').eq(0);\n        $match.removeAttr(splitAttr);\n        $wrapper.append($match);\n        tag = $wrapper.html();\n        $match.remove();\n        markup = $.html();\n        second = reopen + markup.substr(leftAt);\n        // Let Cheerio close the open tags in the\n        // first segment for us. Also mop up the attributes\n        // we used to mark elements that matched the selector\n        // but didn't match our test function\n        first = cleanup(first);\n        result.push(first);\n        result.push(tag);\n        html = cleanup(second);\n    }\n    return result;\n    // Use Cheerio to strip out any attributes we used to keep\n    // track of our work, then generate new HTML. This also\n    // closes any tags we opened but did not close.\n    function cleanup(html) {\n        html = cheerio.load(html, cheerioOpts);\n        html('[' + ignoreAttr + ']').removeAttr(ignoreAttr);\n        html = html.html();\n        return html;\n    }\n\n    function token() {\n        return Math.floor(Math.random() * 1000000000).toString();\n    }\n}\n\nfunction tagName($el) {\n    // Different in DOM and Cheerio. Cheerio\n    // doesn't support prop() either.\n    return $el[0].tagName || $el[0].name;\n}\n\nexport function BookHTMLToJSON(html) {\n    var sanitizeHtml = require('sanitize-html');\n\n    var cleanHTML = sanitizeHtml(html, {\n        allowedTags: sanitizeHtml.defaults.allowedTags.concat([ 'img' ])\n    });\n\n    console.log(html);\n\n    var style = getFilteredCSS(html);\n\n    const splitHtmlResult = splitHtml(html, 'h1');\n\n    console.log(splitHtmlResult)\n\n    var chapterArray = []\n\n    // start from one because first element is always ''\n    for (let index = 1; index < splitHtmlResult.length - 1; index = index + 2) {\n\n        // structure of the array that is expected\n        // h1 chapterHtml h1 chapterHtml\n\n        // TODO: handle error cases when array is not in valid format.\n        let title_with_h1 = splitHtmlResult[index]\n        let chapter_html = splitHtmlResult[index + 1]\n\n        let root = parse(title_with_h1)\n\n        let chapter_name_text = root.querySelector('h1').text;\n\n        let chapter = {\n            \"name\" : chapter_name_text,\n            \"page\" : {\n                \"html\" : title_with_h1 + chapter_html\n            }\n        }\n        chapterArray.push(chapter);\n    }\n\n    return {\n        \"book\": {\n            \"name\": \"DEFAULT NAME\",\n            \"currentSelectedChapter\" : 0, // default chapter is 1st.\n            \"chapters\": chapterArray,\n            \"style\" : \"<style>\" + style + \"</style>\"\n        }\n    }\n}\n\nfunction getFilteredCSS(html) {\n    const doc = new DOMParser().parseFromString(html, \"text/html\");\n    const cssStr = [...doc.querySelectorAll('style')]\n        .map(style => style.textContent);\n\n    const filterCss = require('filter-css');\n\n\n    // filter the css to remove everything but font-weight information.\n    // TODO: add more filters as necessary.\n    const filtered = filterCss(cssStr[0], [/li/, /color/, /font-family/, /font-size/, /h[1-6]/, /margin/, /margin-top/, /margin-bottom/, /margin-left/, /margin-right/, /padding/, /padding-top/, /padding-bottom/, /padding-left/, /padding-right/ ]);\n\n    console.log(filtered);\n    return filtered;\n\n}","import firebase from \"firebase\";\nrequire('firebase/auth')\n\nvar firebaseConfig = {\n    apiKey: \"AIzaSyCInI4F3bp_ie9o10iVc3tDVOfG0STBqHA\",\n    authDomain: \"picasso-298120.firebaseapp.com\",\n    projectId: \"picasso-298120\",\n    storageBucket: \"picasso-298120.appspot.com\",\n    messagingSenderId: \"980742080089\",\n    appId: \"1:980742080089:web:7c4fb1dc9c7cc3f7e99348\",\n    measurementId: \"G-JQDVJQK6T8\"\n};\n\n// init firebase\nif (!firebase.apps.length) {\n    firebase.initializeApp(firebaseConfig);\n}else {\n    firebase.app(); // if already initialized, use that one\n}\nfirebase.analytics();\n\nexport let f_db = firebase.firestore();\nexport let f_auth = firebase.auth();\nexport let auth = firebase.auth\nexport let f_storage_ref = firebase.storage().ref();\n\nexport default {f_db, f_auth, f_storage_ref};","// Import FirebaseAuth and firebase.\nimport React from 'react';\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport {auth, f_auth} from \"../config/firebase\";\n\n\nconst uiConfig = {\n    // Popup signin flow rather than redirect flow.\n    signInFlow: 'popup',\n    signInSuccessUrl: '/picasso/',\n    // We will display email as auth provider.\n    signInOptions: [\n        auth.EmailAuthProvider.PROVIDER_ID,\n    ],\n};\n\nfunction SignInScreen() {\n    return (\n        <div>\n            <StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={f_auth} />\n        </div>\n    );\n}\n\nexport default SignInScreen","export default __webpack_public_path__ + \"static/media/logo.f5577065.svg\";","export default __webpack_public_path__ + \"static/media/bookmark_border.7ab6e61e.svg\";","export default __webpack_public_path__ + \"static/media/note_add.deaa3c98.svg\";","export default __webpack_public_path__ + \"static/media/search.c49eb908.svg\";","export default __webpack_public_path__ + \"static/media/volume_up.f92f4a65.svg\";","\nimport {BookHTMLToJSON} from \"./BookHTMLToJSONBuilder\";\nimport {f_storage_ref} from \"../config/firebase\";\n\n\nfunction bring_it_in(docId) {\n    if (docId === null) return\n    console.log(docId)\n    // this.setState({bookID : docId, pending : true});\n    var url = \"https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id=\"+docId+\"&exportFormat=html\";\n    console.log(url)\n\n    fetch(url)\n        .then(response => response.text()\n        )\n        .then(contents => {\n            // console.log(contents)\n            conversion(contents, docId);\n        })\n        .catch(console.log)\n}\n\nfunction conversion(html, docID) {\n    let json = BookHTMLToJSON(html)\n    console.log(json)\n    upload(json, docID);\n}\n\nfunction upload (json, docID) {\n    let newBookRef = f_storage_ref.child(\"/books/\" + docID + \".json\");\n\n    var jsonString = JSON.stringify(json);\n\n    var blob = new Blob([jsonString], {type: \"application/json\"})\n\n    newBookRef.put(blob).then(function(snapshot) {\n        console.log('Uploaded ', docID, \".json\");\n        window.location.reload()\n    });\n\n}\nexport default function refresh(){\n\n    let url = new URL(window.location.href)\n\n    // http://localhost:3000/picasso/read/1zx7anhYvwI5d0TCsMH3jY4Ho3Ki7j5nBGB0kqO9VCLY\n    // 3 is the google document id!\n    let docID = url.hash.split(\"/\")[2];\n\n    console.log(url.hash)\n    bring_it_in(docID)\n}","import React, { Component } from 'react';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport './NavBar.css'\nimport BookMark from './svg/bookmark_border.svg'\nimport AddNote from './svg/note_add.svg'\nimport Search from './svg/search.svg'\nimport Audio from './svg/volume_up.svg'\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport refresh from \"../../../utils/refresh\";\n\nexport class Controls extends Component {\n\n    render() {\n        function handleClick(e) {\n            e.preventDefault();\n            console.log('The link was clicked.');\n        }\n        return(\n            <div className=\"navbar_controls\">\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={Audio} alt=\"play audio button\" onClick={handleClick}/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={BookMark} alt=\"bookmark button\"/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={AddNote} alt=\"add note button\"/></IconButton>\n                <IconButton color=\"primary\" aria-label=\"upload picture\" component=\"span\">\n                    <img src={Search} alt=\"search button\"/></IconButton>\n                <IconButton aria-label=\"upload picture\" component=\"span\" onClick={refresh}>\n                    <RefreshIcon/></IconButton>\n            </div>\n\n        )\n    }\n}\n\nexport default Controls;","import React, {Component} from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from \"@material-ui/core/Typography\";\nimport Card from \"@material-ui/core/Card\";\nimport DashboardIcon from '@material-ui/icons/Dashboard';\nimport onClickOutside from \"react-onclickoutside\";\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport {f_auth} from \"../../../../config/firebase\";\nimport {Link} from 'react-router-dom'\nimport AddBoxIcon from '@material-ui/icons/AddBox';\n\n\nclass AccountInformation extends Component {\n\n    handleClickOutside = evt => {\n        this.props.outsideClickHandler(evt)\n    };\n\n    logout = () => {\n        console.log(\"Logout\")\n        f_auth.signOut();\n    }\n\n    render() {\n        let style = {\n            minWidth: '15rem',\n            position : 'fixed',\n            top : '0',\n            right : '0',\n            margin : '5.5rem 2.8rem'\n        }\n        if (!this.props.show) {return null}\n\n        return (\n            <div style={style}>\n\n            <Card>\n                    <Typography variant=\"h6\" align=\"center\" style={{marginTop : '1rem'}}>Hi, {f_auth.currentUser.displayName || null}!</Typography>\n\n                <Divider/>\n\n                <List component=\"nav\" aria-label=\"main mailbox folders\">\n                    <ListItem button onClick={this.import}>\n\n                        <Link to={\"/add\"} style = {{display : 'flex', textDecoration : 'none', color: 'black'}}>\n                            <ListItemIcon>\n                                <AddBoxIcon />\n                            </ListItemIcon>\n\n                            <ListItemText primary=\"Import\" />\n                        </Link>\n                    </ListItem>\n                    <ListItem button>\n                        <ListItemIcon>\n                            <DashboardIcon />\n                        </ListItemIcon>\n                        <ListItemText primary=\"Dashboard\" />\n                    </ListItem>\n                    <ListItem button onClick={this.logout}>\n                        <ListItemIcon>\n                            <ExitToAppIcon />\n                        </ListItemIcon>\n                        <ListItemText primary=\"Logout\" />\n                    </ListItem>\n                </List>\n\n            </Card>\n            </div>\n        );\n    }\n}\n\nexport default onClickOutside(AccountInformation);\n","import './NavBar.css';\nimport Logo from './svg/logo.svg'\nimport Controls from './Controls'\nimport Avatar from \"@material-ui/core/Avatar\";\nimport React, {Component} from 'react';\nimport AccountInformation from \"./Account/AccountInformation\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport {f_auth} from \"../../../config/firebase\";\n\nclass NavBar extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            showAccountInformation: false\n        }\n    }\n    // prevents dragging of the icons.\n    preventDragHandler = (e) => {\n        e.preventDefault();\n    };\n\n    avatarClicked = () => {\n        console.log(\"Avatar clicked.\")\n        this.setState({showAccountInformation : !this.state.showAccountInformation})\n    }\n\n    clickedOutsideHandler = (e) => {\n        if (e.target.id !== \"avatar_btn\"){\n            console.log(\"clicked outside\", e)\n            this.setState({showAccountInformation : false})\n        }\n    }\n\n    render(){\n\n        let name = f_auth.currentUser.displayName || \"\"\n\n        return (\n            <div onDragStart={this.preventDragHandler}>\n                <div className=\"navbar\">\n                    <img src={Logo} height=\"50rem\" alt=\"company logo\"/>\n                    <Controls/>\n                    <IconButton onClick={this.avatarClicked} ><Avatar className=\"avatar\" id=\"avatar_btn\">{name.charAt(0).toUpperCase() || null}</Avatar></IconButton>\n                </div>\n                <AccountInformation show = {this.state.showAccountInformation} outsideClickHandler = {this.clickedOutsideHandler}/>\n            </div>\n        );\n    }\n\n}\n\n\nexport default NavBar;","export default __webpack_public_path__ + \"static/media/bookmark_border.da01c847.svg\";","import React, {Component} from \"react\";\nimport BookMark from './svg/bookmark_border.svg'\nimport Button from \"@material-ui/core/Button\";\nimport { withStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Chip from \"@material-ui/core/Chip\";\nimport {Avatar} from \"@material-ui/core\";\n\nexport class SideBar extends Component{\n\n    render() {\n        let chapterList = this.props.book.chapters;\n        const SideBarElementList = []\n\n        let sidebar_style = {\n            marginTop: '3rem',\n            display: 'inline-flex',\n            flexDirection: 'column',\n            position: 'fixed'\n        };\n\n        const StyledButton = withStyles({\n            root: {\n                borderRadius: '0',\n                fontSize: '1rem',\n                fontWeight: '400',\n                padding: '0',\n                borderBottomRightRadius: '3rem',\n                borderTopRightRadius: '3rem'\n            },\n            label: {\n                textTransform: 'none',\n            },\n        })(Button);\n\n        for (const [index, chapter] of chapterList.entries()) {\n            SideBarElementList.push(<StyledButton key = {index} onClick = {() => this.props.handler(index)}><SideBarElement name = {chapter.name}\n                                                                                isBookmarked = {chapter.isBookmarked}\n                                                                                isSelected = {index === this.props.currentSelectedChapter}\n                                                                                index = {index}\n            /></StyledButton>)\n        }\n\n        return(\n            <div style={sidebar_style}>\n                {SideBarElementList}\n            </div>\n        );\n    }\n}\n\nlet SideBarElement = function statelessFunctionComponentClass(props) {\n\n    let isBookmarked = props.isBookmarked;\n    let name = props.name.trim();\n    let isSelected = props.isSelected;\n    let style = {\n        width: '13rem',\n        height: '3.5rem',\n        paddingLeft: '1.5rem',\n        paddingRight: '1rem',\n        display: 'inline-flex',\n        alignItems: 'center',\n        backgroundColor: isSelected ? '#E3F2FD' : '',\n        borderBottomRightRadius: '3rem',\n        borderTopRightRadius: '3rem',\n        color : isSelected ? '#2196F3' : 'black',\n        fontWeight: '500',\n    };\n\n    let textStyle = {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap'\n    }\n\n    const HtmlTooltip = withStyles((theme) => ({\n        tooltip: {\n            fontSize: theme.typography.pxToRem(12),\n        },\n    }))(Tooltip);\n\n    let chipStyle = {\n        marginRight: '0.5rem',\n        color : isSelected ? 'white' : 'black',\n        backgroundColor : isSelected ? '#2196F3' : '',\n    }\n\n\n    return (\n        <HtmlTooltip title = {name} arrow placement=\"right\">\n        <div style={style}>\n            <Chip size=\"small\" label= {props.index + 1} style={chipStyle} variant={isSelected ? 'default' : 'outlined'}/>\n\n            <span style={textStyle}>{name}</span>\n        </div>\n        </HtmlTooltip>\n    );\n};","import React, {Component} from \"react\";\nimport {Button, Divider} from \"@material-ui/core\";\nimport TextField from \"@material-ui/core/TextField\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport { RadioGroup, RadioButton } from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class ResponseQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            oldResponse : \"\",\n            needsFirebaseLoading : true,\n            dirty: false,\n        }\n    }\n\n    saveResponse = () => {\n        if (this.state.response == \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase();\n        this.setState({hasResponded : true})\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (e) => {\n        console.log(\"onChangeResponse\")\n        this.setState({response : e.target.value})\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"RESPONSE_QUESTION\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                    referenceToOldThis.setState({dirty : true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = () => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"RESPONSE_QUESTION\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                referenceToOldThis.setState({dirty : true})\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response : referenceToOldThis.state.response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: referenceToOldThis.state.response,\n                        bookID : referenceToOldThis.props.bookID,\n                        type: \"RESPONSE_QUESTION\"\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    cancelEdit = () => {\n        this.setState({response : this.state.oldResponse})\n        this.setState({hasResponded : true})\n    }\n\n    render() {\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let questionText = this.props.questionText;\n\n        let responseFieldStyle = {\n            width: '100%',\n            marginBottom : '1rem',\n            marginTop : '1rem'\n        }\n\n        let responseQuestion =\n            <Box className='responseQuestionBox' boxShadow = {2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{questionText[1].trim()}</b></p>\n                    <TextField\n                        style={responseFieldStyle}\n                        label=\"Response\"\n                        multiline\n                        onChange={this.onChangeResponse}\n                        defaultValue={this.state.response}\n                    />\n                    <div>\n                        <Button variant=\"contained\" color=\"primary\" style={{float : 'right'}} onClick={this.saveResponse}>RESPOND</Button>\n                        <Button variant=\"contained\" color=\"delete\" style={{float : 'right', marginRight: '1rem', visibility : this.state.dirty ? 'visible' : 'hidden'}} onClick={this.cancelEdit}>Cancel</Button>\n                    </div>\n                </div>\n            </Box>\n\n        let responseQuestionRespondedView =\n            <Box className='responseQuestionBox' boxShadow = {2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{questionText[1].trim()}</b></p>\n                    <Divider/>\n                    <p className=\"p-no-margin\">{this.state.response}</p>\n                    <div style={{float : 'right'}}>\n                        <Button variant=\"contained\" onClick={this.onEdit}>EDIT</Button>\n                    </div>\n                </div>\n            </Box>\n\n        if (this.state.hasResponded){\n            return responseQuestionRespondedView;\n        }\n        else return responseQuestion;\n    }\n}","import React, {Component} from \"react\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport {RadioButton, RadioGroup} from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class TrueFalseQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            needsFirebaseLoading : true,\n            error: false,\n        }\n    }\n\n    saveResponse = (response) => {\n        if (response === \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase(response);\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (value) => {\n        console.log(\"onChangeResponse\", value)\n        this.setState({response : value})\n        this.saveResponse(value)\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"TRUE_OR_FALSE\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    if (doc.data().type !== \"TRUE_OR_FALSE\"){\n                        console.log(\"ERROR, QUESTION TYPE MISMATCH\");\n                        referenceToOldThis.setState({error : true})\n                        return ;\n                    }\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = (response) => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"TRUE_OR_FALSE\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response :  response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: response,\n                        type: \"TRUE_OR_FALSE\",\n                        bookID : referenceToOldThis.props.bookID\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    cancelEdit = () => {\n        this.setState({response : this.state.oldResponse})\n        this.setState({hasResponded : true})\n    }\n\n    render() {\n\n        if (this.state.error) {\n            return <div>ERROR RENDERING QUESTION. Please contact us.</div>\n        }\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let questionText = this.props.questionText;\n        let question = questionText[1].split(\">\")[0].trim();\n        let correctAnswer = questionText[1].split(\">\")[1].trim().toUpperCase();\n\n        if (this.state.hasResponded) {\n            return <Box className='responseQuestionBox' boxShadow={2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{question}</b></p>\n                    <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                        <RadioGroup onChange={this.onChangeResponse} value={this.state.response} horizontal>\n                            <RadioButton value=\"TRUE\"\n                                         rootColor={\"black\"}\n                                         pointColor={correctAnswer === \"TRUE\" ? \"green\" : \"red\"}>\n                                <b>TRUE</b>\n                            </RadioButton>\n\n                            <RadioButton value=\"FALSE\"\n                                         rootColor={\"black\"}\n                                         pointColor={correctAnswer === \"FALSE\" ? \"green\" : \"red\"}>\n                                <b>FALSE</b>\n                            </RadioButton>\n                        </RadioGroup>\n                    </div>\n                </div>\n            </Box>;\n        }\n\n        return <Box className='responseQuestionBox' boxShadow={2}>\n            <div style={{width: '100%'}}>\n                <p className=\"p-no-margin\"><b>{question}</b></p>\n                <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                    <RadioGroup onChange={this.onChangeResponse} horizontal>\n                        <RadioButton value=\"TRUE\"\n                                     rootColor={\"black\"}\n                                     pointColor={correctAnswer === \"TRUE\" ? \"green\" : \"red\"}>\n                            <b>TRUE</b>\n                        </RadioButton>\n\n                        <RadioButton value=\"FALSE\"\n                                     rootColor={\"black\"}\n                                     pointColor={correctAnswer === \"FALSE\" ? \"green\" : \"red\"}>\n                            <b>FALSE</b>\n                        </RadioButton>\n                    </RadioGroup>\n                </div>\n            </div>\n        </Box>;\n\n    }\n}","import React, {Component} from \"react\";\nimport {f_auth, f_db} from \"../../../../config/firebase\";\nimport Box from '@material-ui/core/Box';\nimport {RadioButton, RadioGroup} from 'react-radio-buttons'\nimport \"./css/styles.css\"\n\nexport class MultipleChoiceQuestion extends Component {\n\n    constructor(props) {\n        super(props);\n\n        let questionText = this.props.questionText;\n        let question = questionText[1].split(\">\")[0].trim();\n\n        var choicesArray = questionText[1].split(\">\").slice(1, questionText[1].split(\">\").length - 1)\n        let correctAnswer = parseInt(questionText[1].split(\">\")[questionText[1].split(\">\").length - 1].trim())\n\n        const items = []\n\n        for (const [index, value] of choicesArray.entries()) {\n            items.push(<RadioButton key={index}\n                                    value = {index + 1}\n                                    rootColor={\"black\"}\n                                    pointColor={correctAnswer === index + 1 ? \"green\" : \"red\"}\n            > {value.trim()} </RadioButton>)\n        }\n\n        this.state = {\n            hasResponded : false,\n            response : \"\",\n            needsFirebaseLoading : true,\n            error: false,\n            question : question,\n            items : items,\n            choicesArray: choicesArray,\n        }\n    }\n\n    saveResponse = (response) => {\n        if (response === \"\") {\n            console.log(\"BLANK\")\n            return;\n        }\n        this.saveToFirebase(response);\n    }\n\n    onEdit = () => {\n        this.setState({oldResponse : this.state.response})\n        this.setState({hasResponded : false})\n    }\n\n    onChangeResponse = (value) => {\n        console.log(\"onChangeResponse\", value)\n        this.setState({response : value})\n        this.saveResponse(value)\n    }\n\n    loadFirebaseResponse = () => {\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"MULTIPLE_CHOICE\")\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    if (doc.data().type !== \"MULTIPLE_CHOICE\"){\n                        console.log(\"ERROR, QUESTION TYPE MISMATCH\");\n                        referenceToOldThis.setState({error : true})\n                        return ;\n                    }\n                    referenceToOldThis.setState({response: doc.data().response})\n                    referenceToOldThis.setState({hasResponded: true})\n                });\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n    saveToFirebase = (response) => {\n\n        var responseAlreadyExists = false;\n\n        var query = f_db.collection(\"answers\");\n        query = query.where(\"studentID\", \"==\", f_auth.currentUser.uid)\n        query = query.where(\"chapterNumber\", \"==\", parseInt(this.props.chapterNumber))\n        query = query.where(\"questionNumber\", \"==\" , parseInt(this.props.questionNumber))\n        query = query.where(\"bookID\", \"==\" , this.props.bookID)\n        query = query.where(\"type\", \"==\" , \"MULTIPLE_CHOICE\")\n\n\n        let referenceToOldThis = this;\n        query.get()\n            .then(function(querySnapshot) {\n                // if document exists then update it else create one\n                querySnapshot.forEach(function(doc) {\n                    doc.ref.update({response : response})\n                    responseAlreadyExists = true;\n                });\n                // if response didnt already exist in the database, add the new response.\n                if (!responseAlreadyExists){\n                    query = f_db.collection(\"answers\").add({\n                        studentID: f_auth.currentUser.uid,\n                        chapterNumber: parseInt(referenceToOldThis.props.chapterNumber),\n                        questionNumber: parseInt(referenceToOldThis.props.questionNumber),\n                        response: response,\n                        type: \"MULTIPLE_CHOICE\",\n                        bookID : referenceToOldThis.props.bookID\n                    })\n                        .then(function(docRef) {\n                            console.log(\"New answer recorded with ID: \", docRef.id);\n                        })\n                        .catch(function(error) {\n                            console.error(\"Error adding answer: \", error);\n                        });\n                }\n                else {\n                    console.log(\"Response updated\")\n                }\n            })\n            .catch(function(error) {\n                console.error(\"Error updating answer: \", error);\n            });\n    }\n\n\n    render() {\n\n        if (this.state.error) {\n            return <div>ERROR RENDERING QUESTION. Please contact us.</div>\n        }\n\n        if (this.state.needsFirebaseLoading) {\n            this.loadFirebaseResponse();\n            this.setState({needsFirebaseLoading : false})\n        }\n\n        let question = this.state.question;\n        let items = this.state.items;\n\n\n        if (this.state.hasResponded) {\n            return <Box className='responseQuestionBox' boxShadow={2}>\n                <div style={{width: '100%'}}>\n                    <p className=\"p-no-margin\"><b>{question}</b></p>\n                    <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                        <RadioGroup onChange={this.onChangeResponse} value={this.state.response} vertical>\n                            {items.map(item => {\n                                return item\n                            })}\n                        </RadioGroup>\n                    </div>\n                </div>\n            </Box>;\n        }\n\n        return <Box className='responseQuestionBox' boxShadow={2}>\n            <div style={{width: '100%'}}>\n                <p className=\"p-no-margin\"><b>{question}</b></p>\n                <div style={{marginTop: '2rem', borderWidth: '2px'}}>\n                    <RadioGroup onChange={this.onChangeResponse} vertical>\n                        {items.map(item => {\n                            return item\n                        })}\n                    </RadioGroup>\n                </div>\n            </div>\n        </Box>;\n    }\n}","import React, {Component} from \"react\";\nimport ReactHtmlParser, {convertNodeToElement} from 'react-html-parser';\nimport ReactPlayer from \"react-player\";\nimport './css/styles.css'\nimport {f_auth, f_db} from '../../../config/firebase'\nimport HashMap from 'hashmap'\nimport {ResponseQuestion} from \"./Question/ResponseQuestion\";\nimport HyvorTalk from \"hyvor-talk-react\";\nimport {TrueFalseQuestion} from \"./Question/TrueFalseQuestion\";\nimport {MultipleChoiceQuestion} from \"./Question/MultipleChoiceQuestion\";\nimport {Box} from \"@material-ui/core\"\n\n// this will save responses for the student in a hashmap;\nvar responseMap = new HashMap();\n\nvar sanitizeHtml = require('sanitize-html');\n\n// global variable to hold the chapter number.\nvar currentChapter = null;\nvar newQuestionId = null;\nvar bookID = null;\n\n\n// TODO: this is the real parser, it needs to be updated to be able to handle images nested in p tags and some scenarios.\n// TODO (known bug): if image is precedded or followed by a QUESTION TYPE, it wont render the image unless the image is\n//  set to be break-text in google docs.\n\nfunction contains(node, tag){\n    if (node === null) return false;\n    if (node.children === undefined) return false;\n\n    // does it have children?\n    for (var i = 0; i < node.children.length; i++){\n        if (node.children[i].name === tag) return true;\n        if (contains(node.children[i], tag) === true) return true;\n    }\n\n    return false;\n}\n\nfunction transform(node, index) {\n    if (node.type === 'tag' && node.name.startsWith('h')){\n        let elementText = getText(node,String());\n        if(!elementText.trim()) return null;\n    }\n\n    if (node.type === 'tag' && node.name === 'img'){\n        console.log(\"IMG FOUND\")\n        return <img src={node.attribs[\"src\"]}  className=\"chapter_img\" alt=\"chapter_img\"/>\n    }\n\n    if (node.type === 'tag' && node.name === 'span'){\n        console.log(\"SPAN FOUND\", node)\n        node.attribs.style = null;\n        return convertNodeToElement(node, index, transform)\n    }\n\n    // TODO: fix image rendering for all cases.\n    if (node.type === 'tag' && node.name === 'p') {\n        console.log(\"P FOUND\", node)\n        // add code to transform any nodes as neccesary\n        let questionText = getText(node,String());\n\n        console.log(contains(node, 'img'))\n\n        if (!questionText.trim() && !contains(node, 'img')) return null;\n\n        if (questionText.startsWith(\"RESPONSE_QUESTION\")){\n\n            let question = questionText.split(\":\")\n\n            return <ResponseQuestion questionNumber = {newQuestionId++}\n                                     chapterNumber={currentChapter}\n                                     questionText = {question}\n                                     bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"TRUE_OR_FALSE\")){\n\n            let question = questionText.split(\":\")\n\n            return <TrueFalseQuestion questionNumber = {newQuestionId++}\n                                      chapterNumber={currentChapter}\n                                      questionText = {question}\n                                      bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"MULTIPLE_CHOICE\")){\n\n            let question = questionText.split(\":\")\n\n            return <MultipleChoiceQuestion questionNumber = {newQuestionId++}\n                                      chapterNumber={currentChapter}\n                                      questionText = {question}\n                                      bookID = {bookID}\n            />\n        }\n\n        if (questionText.startsWith(\"VIDEO_LINK\")){\n            return <Box display={'flex'} justifyContent={\"center\"}>\n                <ReactPlayer url = {urlify(questionText)} />\n            </Box>\n\n        }\n\n        return convertNodeToElement(node, index, transform)\n    }\n}\n\nfunction urlify(text) {\n    var urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n    return text.replace(urlRegex, function(url) {\n        return url\n    })\n}\n\n\nfunction responseChanged(event){\n    responseMap.set(event.target.id, event.target.value)\n    console.log(responseMap)\n}\n\nfunction saveResponse(e){\n    let questionNumber = parseInt(e.currentTarget.id)\n    let studentID = f_auth.currentUser.uid;\n    var responseAlreadyExists = false;\n    let hashKey = e.currentTarget.id;\n\n    if(responseMap.get(hashKey) == null) {\n        console.log(\"Please type an answer first.\")\n        return ;\n    }\n\n    // perform a query and see if response already exists in the database for the student.\n    var query = f_db.collection(\"answers\");\n    query = query.where(\"studentID\", \"==\", studentID)\n    query = query.where(\"chapterNumber\", \"==\", currentChapter)\n    query = query.where(\"questionNumber\", \"==\" , questionNumber)\n\n    query.get()\n        .then(function(querySnapshot) {\n            // if document exists then update it else create one\n            querySnapshot.forEach(function(doc) {\n                doc.ref.update({response : responseMap.get(hashKey)})\n                responseAlreadyExists = true;\n            });\n            // if response didnt already exist in the database, add the new response.\n            if (!responseAlreadyExists){\n                query = f_db.collection(\"answers\").add({\n                    studentID: studentID,\n                    chapterNumber: currentChapter,\n                    questionNumber: questionNumber\n                })\n                    .then(function(docRef) {\n                        console.log(\"New answer recorded with ID: \", docRef.id);\n                    })\n                    .catch(function(error) {\n                        console.error(\"Error adding answer: \", error);\n                    });\n            }\n            else {\n                console.log(\"Response updated\")\n            }\n        })\n        .catch(function(error) {\n            console.error(\"Error updating answer: \", error);\n        });\n}\n\nfunction getText(node, str) {\n    // see if there are children\n    if (node.type === 'text'){\n        return (node.data);\n    }\n\n    for (const child in node.children) {\n        let temp = str.concat(getText(node.children[child], String()))\n        str = temp;\n    }\n    return str;\n}\n\nexport class Chapter extends Component {\n\n    constructor(props) {\n        super(props);\n        this.updateChapterNumberAndResetQuestionID(props.chapterNumber)\n        bookID = this.props.bookID;\n        console.log(props.html)\n    }\n\n    componentWillReceiveProps(nextProps){\n        this.updateChapterNumberAndResetQuestionID(nextProps.chapterNumber)\n    }\n\n    // resets the global variables that keep track of currentchapter and questionID\n    updateChapterNumberAndResetQuestionID(chapterNumber){\n        newQuestionId = 1;\n        currentChapter = chapterNumber;\n    }\n\n    render() {\n\n        console.log(\"Chapter Number\", currentChapter)\n\n        console.log(\"STYLE \", this.props.style)\n\n        let html =\n            \"<html>\" +\n            this.props.style +\n            this.props.html +\n            \"</html>\"\n        ;\n\n\n        let style = {\n            width: '55%',\n            margin: '0 auto'\n        };\n\n        return(\n            <div style={style}>\n                {ReactHtmlParser(html, {transform})}\n                <HyvorTalk.Embed\n                    websiteId={2736}\n                    id={this.props.bookID+\"CHAPTER\"+currentChapter}\n                    key = {currentChapter}\n                />\n            </div>\n        );\n    }\n}\n\n","import \"./TextBookViewer.css\"\nimport NavBar from \"./Components/Navbar/NavBar\"\nimport {SideBar} from \"./Components/SideBar/SideBar\";\nimport {Chapter} from \"./Components/Chapter/Chapter\"\nimport React, {Component} from \"react\";\nimport ProgressBar from \"react-scroll-progress-bar\";\nimport {f_storage_ref} from \"../config/firebase\";\nimport ReactLoading from \"react-loading\";\nimport MediaQuery from 'react-responsive';\n\nclass TextBookViewer extends Component{\n\n    constructor(props) {\n        super(props);\n        console.log(\"Constructor called.\", props.match.params.bookID)\n        this.state = {\n            downloadSuccessful : false,\n            currentChapter : 0,\n            bookID : this.props.match.params.bookID,\n            bookJSON : null\n        }\n    }\n\n    componentDidMount() {\n        this.downloadJSON(this.state.bookID);\n        console.log(\"BOOK ID\", this.state.bookID);\n    }\n\n    downloadJSON = (bookID) => {\n\n        // Create a reference to the file we want to download\n        var bookRef = f_storage_ref.child('books/' + bookID + \".json\");\n\n        // Get the download URL\n        let prefixCORS = \"https://cors-anywhere.herokuapp.com/\";\n\n        let that = this;\n        bookRef.getDownloadURL().then(function(url) {\n            // Insert url into an <img> tag to \"download\"\n            var xhr = new XMLHttpRequest();\n            xhr.responseType = 'blob';\n            xhr.onload = function(event) {\n                var blob = xhr.response;\n                blob.text().then(text => {\n                    that.setState({bookJSON : (JSON.parse(text)),\n                                         downloadSuccessful: true})\n                })\n            };\n            xhr.open('GET', prefixCORS + url);\n            xhr.send();\n        }).catch(function(error) {\n\n            // A full list of error codes is available at\n            // https://firebase.google.com/docs/storage/web/handle-errors\n            switch (error.code) {\n                case 'storage/object-not-found':\n                    // File doesn't exist\n                    break;\n\n                case 'storage/unauthorized':\n                    // User doesn't have permission to access the object\n                    break;\n\n                case 'storage/canceled':\n                    // User canceled the upload\n                    break;\n\n                case 'storage/unknown':\n                    // Unknown error occurred, inspect the server response\n                    break;\n            }\n        });\n    }\n\n    render() {\n\n\n        let canvasStyle = {\n            display: 'flex',\n            flexDirection: 'row'\n        };\n\n        if(this.state.downloadSuccessful){\n\n            let bookJSONObject = this.state.bookJSON\n\n            console.log(bookJSONObject);\n\n            return (\n                <div>\n                    <ProgressBar\n                        height = \"4px\"\n                        bgcolor = \"#1d85d2\"\n                    />\n                    <NavBar/>\n                    <div style={canvasStyle}>\n                        <SideBar handler = {this.onSidebarClick}\n                                 currentSelectedChapter = {this.state.currentChapter}\n                                 book = {bookJSONObject.book}/>\n\n                        <Chapter html = {bookJSONObject.book.chapters[this.state.currentChapter].page.html}\n                                 style = {bookJSONObject.book.style}\n                                 chapterNumber = {this.state.currentChapter}\n                                 bookID = {this.state.bookID}\n                        />\n                    </div>\n                </div>\n            );\n        }\n        else {\n            return <div\n                style={{\n                    position: 'absolute', left: '50%', top: '50%',\n                    transform: 'translate(-50%, -50%)'\n                }}>\n\n                <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n            </div>\n        }\n    }\n\n    onSidebarClick = (index) => {\n\n        // this.state.bookJSON.book[\"currentSelectedChapter\"] = index;\n        this.updateJsonInFirebase();\n        this.setState({currentChapter : index})\n    }\n\n    updateJsonInFirebase = () => {\n        console.log(\"TODO: Implement firebase JSON update.\")\n    }\n}\n\nexport default TextBookViewer;\n","import React, { useEffect, useState } from \"react\";\nimport {f_auth} from \"./config/firebase\";\nimport ReactLoading from 'react-loading';\n\nexport const AuthContext = React.createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [currentUser, setCurrentUser] = useState(null);\n    const [pending, setPending] = useState(true);\n\n    useEffect(() => {\n        f_auth.onAuthStateChanged((user) => {\n            console.log(user)\n            setCurrentUser(user)\n            setPending(false)\n        });\n    }, []);\n\n    if(pending){\n        return <div\n            style={{\n                position: 'absolute', left: '50%', top: '50%',\n                transform: 'translate(-50%, -50%)'\n            }}\n        >\n             <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n        </div>\n\n    }\n\n    return (\n        <AuthContext.Provider\n            value={{\n                currentUser\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n};","import React, { useContext } from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\nimport { AuthContext } from \"./Auth\";\n\nconst PrivateRoute = ({ component: RouteComponent, ...rest }) => {\n\n    const {currentUser} = useContext(AuthContext);\n\n    console.log(currentUser);\n    return (\n        <Route\n            {...rest}\n            render={routeProps =>\n                !!currentUser ? (\n                    <RouteComponent {...routeProps} />\n                ) : (\n                    <Redirect to={\"/signin/\"} />\n                )\n            }\n        />\n    );\n};\n\n\nexport default PrivateRoute","import React from \"react\";\nimport {TextField} from \"@material-ui/core\";\nimport {Button} from \"@material-ui/core\";\nimport {Box} from \"@material-ui/core\";\nimport {Redirect } from \"react-router-dom\";\nimport {BookHTMLToJSON} from \"../utils/BookHTMLToJSONBuilder\";\nimport {f_storage_ref} from \"../config/firebase\"\nimport ReactLoading from \"react-loading\";\n\nexport default class AddBookScreen extends React.Component{\n\n    constructor() {\n        super();\n        this.state =  {\n            importSuccessful : false,\n            bookID : \"\",\n            documentLink : \"\",\n            pending : false,\n        }\n    }\n\n    import = () => {\n        if (this.state.documentLink === '') return ;\n        var docId = new RegExp(\"/document/d/([a-zA-Z0-9-_]+)\").exec(this.state.documentLink)[1];\n        console.log(docId)\n        this.setState({bookID : docId, pending : true});\n        var url = \"https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id=\"+docId+\"&exportFormat=html\";\n        console.log(url)\n\n        fetch(url)\n            .then(response => response.text()\n            )\n            .then(contents => {\n                // console.log(contents)\n                this.conversion(contents);\n            })\n            .catch(console.log)\n    }\n\n    conversion = (html) => {\n        let json = BookHTMLToJSON(html)\n        console.log(json)\n        this.upload(json);\n    }\n\n    upload = (json) => {\n        let newBookRef = f_storage_ref.child(\"/books/\" + this.state.bookID + \".json\");\n\n        var jsonString = JSON.stringify(json);\n\n        var blob = new Blob([jsonString], {type: \"application/json\"})\n\n        let that = this\n        newBookRef.put(blob).then(function(snapshot) {\n            console.log('Uploaded ', that.state.bookID, \".json\");\n            that.setState({importSuccessful : true, pending : false})\n\n        });\n\n    }\n\n    _handleTextfieldChange = (e) => {\n        this.setState({documentLink : e.target.value})\n    }\n\n    render() {\n        if (this.state.importSuccessful){\n            return <Redirect to={\"../read/\" + this.state.bookID}/>\n        }\n\n        if (this.state.pending){\n            return <div\n                style={{\n                    position: 'absolute', left: '50%', top: '50%',\n                    transform: 'translate(-50%, -50%)'\n                }}\n            >\n                <ReactLoading color={\"#1d85d2\"} type={\"bars\"}/>\n            </div>\n        }\n\n        return <div>\n                <h3 style={{textAlign : 'center'}}>What's your Google Doc link?</h3>\n                <Box display=\"flex\" justifyContent=\"center\">\n                    <TextField id=\"outlined-basic\" placeholder={\"https://docs.google.com/document/...\"} variant=\"outlined\" style={{width : '40rem'}} onChange={this._handleTextfieldChange} />\n                    <Button type={\"submit\"} color=\"primary\" onClick={() => {this.import()}}>IMPORT</Button>\n                </Box>\n            </div>\n    }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {HashRouter as Router, Switch, Route, Redirect} from 'react-router-dom'\nimport SignInScreen from \"./Login/SignIn\";\nimport TextBookViewer from \"./Textbook/TextBookViewer\";\nimport {AuthProvider} from \"./Auth\";\nimport PrivateRoute from \"./PrivateRoute\";\nimport AddBookScreen from \"./AddBook/AddBookScreen\"\n\n\nlet DEBUG_MODE_ON = true;\n\nif (!DEBUG_MODE_ON) {\n    console = console || {};\n    console.log = function(){};\n}\n\nconsole.log(\"index.js called.\")\n\nReactDOM.render(\n  <React.StrictMode>\n      <AuthProvider>\n          <Router basename = '/'>\n              <Switch>\n                  <Route path=\"/signin/\"> <SignInScreen /> </Route>\n                  <Route path=\"/add/\"> <AddBookScreen /> </Route>\n                  <PrivateRoute path=\"/read/:bookID\" exact component={TextBookViewer}></PrivateRoute>\n                  <Route path=\"*\"><Redirect to=\"/add/\" /></Route>\n              </Switch>\n          </Router>\n      </AuthProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}