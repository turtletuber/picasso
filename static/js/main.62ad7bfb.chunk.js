(this.webpackJsonppicasso=this.webpackJsonppicasso||[]).push([[0],{170:function(e,t,n){},189:function(e,t,n){},224:function(e,t){},292:function(e,t,n){},301:function(e,t,n){},323:function(e,t){},377:function(e,t){},405:function(e,t){},459:function(e,t,n){},481:function(e,t,n){},509:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n(1),s=n.n(r),a=n(18),i=n.n(a),c=(n(292),n(71)),l=n(25),d=n(257),u=n.n(d),p=n(55);n(186);p.a.apps.length?p.a.app():p.a.initializeApp({apiKey:"AIzaSyCInI4F3bp_ie9o10iVc3tDVOfG0STBqHA",authDomain:"picasso-298120.firebaseapp.com",projectId:"picasso-298120",storageBucket:"picasso-298120.appspot.com",messagingSenderId:"980742080089",appId:"1:980742080089:web:7c4fb1dc9c7cc3f7e99348",measurementId:"G-JQDVJQK6T8"}),p.a.analytics();var h=p.a.firestore(),b=p.a.auth(),j=p.a.auth,m=p.a.storage().ref(),f={signInFlow:"popup",signInSuccessUrl:"/picasso/",signInOptions:[j.EmailAuthProvider.PROVIDER_ID]};var O=function(){return Object(o.jsx)("div",{children:Object(o.jsx)(u.a,{uiConfig:f,firebaseAuth:b})})},g=n(16),x=n(17),v=n(31),y=n(20),k=n(19),I=(n(301),n(189),n.p+"static/media/logo.f5577065.svg"),w=n(239),S=n.p+"static/media/bookmark_border.7ab6e61e.svg",R=n.p+"static/media/note_add.deaa3c98.svg",N=n.p+"static/media/search.c49eb908.svg",C=n.p+"static/media/volume_up.f92f4a65.svg",E=n(262),D=n.n(E),T=n(87);function L(e){if(null!==e){console.log(e);var t="https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id="+e+"&exportFormat=html";console.log(t),fetch(t).then((function(e){return e.text()})).then((function(t){!function(e,t){var n=Object(T.a)(e);console.log(n),function(e,t){var n=m.child("/books/"+t+".json"),o=JSON.stringify(e),r=new Blob([o],{type:"application/json"});n.put(r).then((function(e){console.log("Uploaded ",t,".json"),window.location.reload()}))}(n,t)}(t,e)})).catch(console.log)}}function F(){var e=new URL(window.location.href),t=e.hash.split("/")[2];console.log(e.hash),L(t)}var U=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){return Object(o.jsxs)("div",{className:"navbar_controls",children:[Object(o.jsx)(w.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:C,alt:"play audio button",onClick:function(e){e.preventDefault(),console.log("The link was clicked.")}})}),Object(o.jsx)(w.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:S,alt:"bookmark button"})}),Object(o.jsx)(w.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:R,alt:"add note button"})}),Object(o.jsx)(w.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(o.jsx)("img",{src:N,alt:"search button"})}),Object(o.jsx)(w.a,{"aria-label":"upload picture",component:"span",onClick:F,children:Object(o.jsx)(D.a,{})})]})}}]),n}(r.Component),A=n(553),q=n(543),_=n(544),B=n(545),P=n(546),H=n(542),Q=n(140),M=n(541),J=n(265),W=n.n(J),G=n(263),z=n(266),K=n.n(z),V=n(264),Y=n.n(V),Z=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(g.a)(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleClickOutside=function(t){e.props.outsideClickHandler(t)},e.logout=function(){console.log("Logout"),b.signOut()},e}return Object(x.a)(n,[{key:"render",value:function(){return this.props.show?Object(o.jsx)("div",{style:{minWidth:"15rem",position:"fixed",top:"0",right:"0",margin:"5.5rem 2.8rem"},children:Object(o.jsxs)(M.a,{children:[Object(o.jsxs)(Q.a,{variant:"h6",align:"center",style:{marginTop:"1rem"},children:["Hi, ",b.currentUser.displayName||null,"!"]}),Object(o.jsx)(H.a,{}),Object(o.jsxs)(q.a,{component:"nav","aria-label":"main mailbox folders",children:[Object(o.jsx)(_.a,{button:!0,onClick:this.import,children:Object(o.jsxs)(c.b,{to:"/add",style:{display:"flex",textDecoration:"none",color:"black"},children:[Object(o.jsx)(B.a,{children:Object(o.jsx)(Y.a,{})}),Object(o.jsx)(P.a,{primary:"Import"})]})}),Object(o.jsxs)(_.a,{button:!0,children:[Object(o.jsx)(B.a,{children:Object(o.jsx)(W.a,{})}),Object(o.jsx)(P.a,{primary:"Dashboard"})]}),Object(o.jsxs)(_.a,{button:!0,onClick:this.logout,children:[Object(o.jsx)(B.a,{children:Object(o.jsx)(K.a,{})}),Object(o.jsx)(P.a,{primary:"Logout"})]})]})]})}):null}}]),n}(r.Component),X=Object(G.a)(Z),$=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).preventDragHandler=function(e){e.preventDefault()},o.avatarClicked=function(){console.log("Avatar clicked."),o.setState({showAccountInformation:!o.state.showAccountInformation})},o.clickedOutsideHandler=function(e){"avatar_btn"!==e.target.id&&(console.log("clicked outside",e),o.setState({showAccountInformation:!1}))},o.state={showAccountInformation:!1},o}return Object(x.a)(n,[{key:"render",value:function(){var e=b.currentUser.displayName||"";return Object(o.jsxs)("div",{onDragStart:this.preventDragHandler,children:[Object(o.jsxs)("div",{className:"navbar",children:[Object(o.jsx)("img",{src:I,height:"50rem",alt:"company logo"}),Object(o.jsx)(U,{}),Object(o.jsx)(w.a,{onClick:this.avatarClicked,children:Object(o.jsx)(A.a,{className:"avatar",id:"avatar_btn",children:e.charAt(0).toUpperCase()||null})})]}),Object(o.jsx)(X,{show:this.state.showAccountInformation,outsideClickHandler:this.clickedOutsideHandler})]})}}]),n}(r.Component),ee=n(54),te=n(89),ne=(n.p,n(547)),oe=n(10),re=n(554),se=n(555),ae=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(){return Object(g.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.book.chapters,r=[],s=Object(oe.a)({root:{borderRadius:"0",fontSize:"1rem",fontWeight:"400",padding:"0",borderBottomRightRadius:"3rem",borderTopRightRadius:"3rem"},label:{textTransform:"none"}})(ne.a),a=Object(te.a)(n.entries());try{var i=function(){var n=Object(ee.a)(e.value,2),a=n[0],i=n[1];r.push(Object(o.jsx)(s,{onClick:function(){return t.props.handler(a)},children:Object(o.jsx)(ie,{name:i.name,isBookmarked:i.isBookmarked,isSelected:a===t.props.currentSelectedChapter,index:a})},a))};for(a.s();!(e=a.n()).done;)i()}catch(c){a.e(c)}finally{a.f()}return Object(o.jsx)("div",{style:{marginTop:"3rem",display:"inline-flex",flexDirection:"column",position:"fixed"},children:r})}}]),n}(r.Component),ie=function(e){e.isBookmarked;var t=e.name.trim(),n=e.isSelected,r={width:"13rem",height:"3.5rem",paddingLeft:"1.5rem",paddingRight:"1rem",display:"inline-flex",alignItems:"center",backgroundColor:n?"#E3F2FD":"",borderBottomRightRadius:"3rem",borderTopRightRadius:"3rem",color:n?"#2196F3":"black",fontWeight:"500"},s=Object(oe.a)((function(e){return{tooltip:{fontSize:e.typography.pxToRem(12)}}}))(re.a),a={marginRight:"0.5rem",color:n?"white":"black",backgroundColor:n?"#2196F3":""};return Object(o.jsx)(s,{title:t,arrow:!0,placement:"right",children:Object(o.jsxs)("div",{style:r,children:[Object(o.jsx)(se.a,{size:"small",label:e.index+1,style:a,variant:n?"default":"outlined"}),Object(o.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t})]})})},ce=n(138),le=n.n(ce),de=n(268),ue=n.n(de),pe=(n(459),n(269)),he=n.n(pe),be=n(550),je=n(552),me=n(43),fe=(n(170),function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).saveResponse=function(){""!=o.state.response?(o.saveToFirebase(),o.setState({hasResponded:!0})):console.log("BLANK")},o.onEdit=function(){o.setState({oldResponse:o.state.response}),o.setState({hasResponded:!1})},o.onChangeResponse=function(e){console.log("onChangeResponse"),o.setState({response:e.target.value})},o.loadFirebaseResponse=function(){var e=h.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","RESPONSE_QUESTION");var t=Object(v.a)(o);e.get().then((function(e){e.forEach((function(e){t.setState({response:e.data().response}),t.setState({hasResponded:!0}),t.setState({dirty:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.saveToFirebase=function(){var e=!1,t=h.collection("answers");t=(t=(t=(t=(t=t.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","RESPONSE_QUESTION");var n=Object(v.a)(o);t.get().then((function(o){n.setState({dirty:!0}),o.forEach((function(t){t.ref.update({response:n.state.response}),e=!0})),e?console.log("Response updated"):t=h.collection("answers").add({studentID:b.currentUser.uid,chapterNumber:parseInt(n.props.chapterNumber),questionNumber:parseInt(n.props.questionNumber),response:n.state.response,bookID:n.props.bookID,type:"RESPONSE_QUESTION"}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.cancelEdit=function(){o.setState({response:o.state.oldResponse}),o.setState({hasResponded:!0})},o.state={hasResponded:!1,response:"",oldResponse:"",needsFirebaseLoading:!0,dirty:!1},o}return Object(x.a)(n,[{key:"render",value:function(){this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.props.questionText,t=Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e[1].trim()})}),Object(o.jsx)(be.a,{style:{width:"100%",marginBottom:"1rem",marginTop:"1rem"},label:"Response",multiline:!0,onChange:this.onChangeResponse,defaultValue:this.state.response}),Object(o.jsxs)("div",{children:[Object(o.jsx)(ne.a,{variant:"contained",color:"primary",style:{float:"right"},onClick:this.saveResponse,children:"RESPOND"}),Object(o.jsx)(ne.a,{variant:"contained",color:"delete",style:{float:"right",marginRight:"1rem",visibility:this.state.dirty?"visible":"hidden"},onClick:this.cancelEdit,children:"Cancel"})]})]})}),n=Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e[1].trim()})}),Object(o.jsx)(H.a,{}),Object(o.jsx)("p",{className:"p-no-margin",children:this.state.response}),Object(o.jsx)("div",{style:{float:"right"},children:Object(o.jsx)(ne.a,{variant:"contained",onClick:this.onEdit,children:"EDIT"})})]})});return this.state.hasResponded?n:t}}]),n}(r.Component)),Oe=n(270),ge=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).saveResponse=function(e){""!==e?o.saveToFirebase(e):console.log("BLANK")},o.onEdit=function(){o.setState({oldResponse:o.state.response}),o.setState({hasResponded:!1})},o.onChangeResponse=function(e){console.log("onChangeResponse",e),o.setState({response:e}),o.saveResponse(e)},o.loadFirebaseResponse=function(){var e=h.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","TRUE_OR_FALSE");var t=Object(v.a)(o);e.get().then((function(e){e.forEach((function(e){if("TRUE_OR_FALSE"!==e.data().type)return console.log("ERROR, QUESTION TYPE MISMATCH"),void t.setState({error:!0});t.setState({response:e.data().response}),t.setState({hasResponded:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.saveToFirebase=function(e){var t=!1,n=h.collection("answers");n=(n=(n=(n=(n=n.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(o.props.chapterNumber))).where("questionNumber","==",parseInt(o.props.questionNumber))).where("bookID","==",o.props.bookID)).where("type","==","TRUE_OR_FALSE");var r=Object(v.a)(o);n.get().then((function(o){o.forEach((function(n){n.ref.update({response:e}),t=!0})),t?console.log("Response updated"):n=h.collection("answers").add({studentID:b.currentUser.uid,chapterNumber:parseInt(r.props.chapterNumber),questionNumber:parseInt(r.props.questionNumber),response:e,type:"TRUE_OR_FALSE",bookID:r.props.bookID}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))},o.cancelEdit=function(){o.setState({response:o.state.oldResponse}),o.setState({hasResponded:!0})},o.state={hasResponded:!1,response:"",needsFirebaseLoading:!0,error:!1},o}return Object(x.a)(n,[{key:"render",value:function(){if(this.state.error)return Object(o.jsx)("div",{children:"ERROR RENDERING QUESTION. Please contact us."});this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.props.questionText,t=e[1].split(">")[0].trim(),n=e[1].split(">")[1].trim().toUpperCase();return this.state.hasResponded?Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:t})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsxs)(me.RadioGroup,{onChange:this.onChangeResponse,value:this.state.response,horizontal:!0,children:[Object(o.jsx)(me.RadioButton,{value:"TRUE",rootColor:"black",pointColor:"TRUE"===n?"green":"red",children:Object(o.jsx)("b",{children:"TRUE"})}),Object(o.jsx)(me.RadioButton,{value:"FALSE",rootColor:"black",pointColor:"FALSE"===n?"green":"red",children:Object(o.jsx)("b",{children:"FALSE"})})]})})]})}):Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:t})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsxs)(me.RadioGroup,{onChange:this.onChangeResponse,horizontal:!0,children:[Object(o.jsx)(me.RadioButton,{value:"TRUE",rootColor:"black",pointColor:"TRUE"===n?"green":"red",children:Object(o.jsx)("b",{children:"TRUE"})}),Object(o.jsx)(me.RadioButton,{value:"FALSE",rootColor:"black",pointColor:"FALSE"===n?"green":"red",children:Object(o.jsx)("b",{children:"FALSE"})})]})})]})})}}]),n}(r.Component),xe=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var r;Object(g.a)(this,n),(r=t.call(this,e)).saveResponse=function(e){""!==e?r.saveToFirebase(e):console.log("BLANK")},r.onEdit=function(){r.setState({oldResponse:r.state.response}),r.setState({hasResponded:!1})},r.onChangeResponse=function(e){console.log("onChangeResponse",e),r.setState({response:e}),r.saveResponse(e)},r.loadFirebaseResponse=function(){var e=h.collection("answers");e=(e=(e=(e=(e=e.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(r.props.chapterNumber))).where("questionNumber","==",parseInt(r.props.questionNumber))).where("bookID","==",r.props.bookID)).where("type","==","MULTIPLE_CHOICE");var t=Object(v.a)(r);e.get().then((function(e){e.forEach((function(e){if("MULTIPLE_CHOICE"!==e.data().type)return console.log("ERROR, QUESTION TYPE MISMATCH"),void t.setState({error:!0});t.setState({response:e.data().response}),t.setState({hasResponded:!0})}))})).catch((function(e){console.error("Error updating answer: ",e)}))},r.saveToFirebase=function(e){var t=!1,n=h.collection("answers");n=(n=(n=(n=(n=n.where("studentID","==",b.currentUser.uid)).where("chapterNumber","==",parseInt(r.props.chapterNumber))).where("questionNumber","==",parseInt(r.props.questionNumber))).where("bookID","==",r.props.bookID)).where("type","==","MULTIPLE_CHOICE");var o=Object(v.a)(r);n.get().then((function(r){r.forEach((function(n){n.ref.update({response:e}),t=!0})),t?console.log("Response updated"):n=h.collection("answers").add({studentID:b.currentUser.uid,chapterNumber:parseInt(o.props.chapterNumber),questionNumber:parseInt(o.props.questionNumber),response:e,type:"MULTIPLE_CHOICE",bookID:o.props.bookID}).then((function(e){console.log("New answer recorded with ID: ",e.id)})).catch((function(e){console.error("Error adding answer: ",e)}))})).catch((function(e){console.error("Error updating answer: ",e)}))};var s,a=r.props.questionText,i=a[1].split(">")[0].trim(),c=a[1].split(">").slice(1,a[1].split(">").length-1),l=parseInt(a[1].split(">")[a[1].split(">").length-1].trim()),d=[],u=Object(te.a)(c.entries());try{for(u.s();!(s=u.n()).done;){var p=Object(ee.a)(s.value,2),j=p[0],m=p[1];d.push(Object(o.jsxs)(me.RadioButton,{value:j+1,rootColor:"black",pointColor:l===j+1?"green":"red",children:[" ",m.trim()," "]},j))}}catch(f){u.e(f)}finally{u.f()}return r.state={hasResponded:!1,response:"",needsFirebaseLoading:!0,error:!1,question:i,items:d,choicesArray:c},r}return Object(x.a)(n,[{key:"render",value:function(){if(this.state.error)return Object(o.jsx)("div",{children:"ERROR RENDERING QUESTION. Please contact us."});this.state.needsFirebaseLoading&&(this.loadFirebaseResponse(),this.setState({needsFirebaseLoading:!1}));var e=this.state.question,t=this.state.items;return this.state.hasResponded?Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsx)(me.RadioGroup,{onChange:this.onChangeResponse,value:this.state.response,vertical:!0,children:t.map((function(e){return e}))})})]})}):Object(o.jsx)(je.a,{className:"responseQuestionBox",boxShadow:2,children:Object(o.jsxs)("div",{style:{width:"100%"},children:[Object(o.jsx)("p",{className:"p-no-margin",children:Object(o.jsx)("b",{children:e})}),Object(o.jsx)("div",{style:{marginTop:"2rem",borderWidth:"2px"},children:Object(o.jsx)(me.RadioGroup,{onChange:this.onChangeResponse,vertical:!0,children:t.map((function(e){return e}))})})]})})}}]),n}(r.Component),ve=(new he.a,n(209),null),ye=null,ke=null;function Ie(e,t){if(null===e)return!1;if(void 0===e.children)return!1;for(var n=0;n<e.children.length;n++){if(e.children[n].name===t)return!0;if(!0===Ie(e.children[n],t))return!0}return!1}function we(e,t){if("tag"===e.type&&e.name.startsWith("h")&&!Re(e,String()).trim())return null;if("tag"===e.type&&"img"===e.name)return console.log("IMG FOUND"),Object(o.jsx)("img",{src:e.attribs.src,className:"chapter_img",alt:"chapter_img"});if("tag"===e.type&&"span"===e.name)return console.log("SPAN FOUND",e),e.attribs.style=null,Object(ce.convertNodeToElement)(e,t,we);if("tag"===e.type&&"p"===e.name){console.log("P FOUND",e);var n=Re(e,String());if(console.log(Ie(e,"img")),!n.trim()&&!Ie(e,"img"))return null;if(n.startsWith("RESPONSE_QUESTION")){var r=n.split(":");return Object(o.jsx)(fe,{questionNumber:ye++,chapterNumber:ve,questionText:r,bookID:ke})}if(n.startsWith("TRUE_OR_FALSE")){var s=n.split(":");return Object(o.jsx)(ge,{questionNumber:ye++,chapterNumber:ve,questionText:s,bookID:ke})}if(n.startsWith("MULTIPLE_CHOICE")){var a=n.split(":");return Object(o.jsx)(xe,{questionNumber:ye++,chapterNumber:ve,questionText:a,bookID:ke})}return n.startsWith("VIDEO_LINK")?Object(o.jsx)(je.a,{display:"flex",justifyContent:"center",children:Object(o.jsx)(ue.a,{url:Se(n)})}):Object(ce.convertNodeToElement)(e,t,we)}}function Se(e){return e.replace(/(https?:\/\/[^\s]+)/g,(function(e){return e}))}function Re(e,t){if("text"===e.type)return e.data;for(var n in e.children){var o=t.concat(Re(e.children[n],String()));t=o}return t}var Ne=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).updateChapterNumberAndResetQuestionID(e.chapterNumber),ke=o.props.bookID,console.log(e.html),o}return Object(x.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.updateChapterNumberAndResetQuestionID(e.chapterNumber)}},{key:"updateChapterNumberAndResetQuestionID",value:function(e){ye=1,ve=e}},{key:"render",value:function(){console.log("Chapter Number",ve),console.log("STYLE ",this.props.style);var e="<html>"+this.props.style+this.props.html+"</html>";return Object(o.jsxs)("div",{style:{width:"55%",margin:"0 auto"},children:[le()(e,{transform:we}),Object(o.jsx)(Oe.a.Embed,{websiteId:2736,id:this.props.bookID+"CHAPTER"+ve},ve)]})}}]),n}(r.Component),Ce=n(271),Ee=n.n(Ce),De=n(62),Te=n.n(De),Le=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).downloadJSON=function(e){var t=m.child("books/"+e+".json"),n=Object(v.a)(o);t.getDownloadURL().then((function(e){console.log("Downloading...");var t=new XMLHttpRequest;t.responseType="blob",t.onload=function(e){t.response.text().then((function(e){n.setState({bookJSON:JSON.parse(e),downloadSuccessful:!0})}))},t.withCredentials=!1,t.open("GET",e),t.send()})).catch((function(e){e.code}))},o.onSidebarClick=function(e){o.updateJsonInFirebase(),o.setState({currentChapter:e})},o.updateJsonInFirebase=function(){console.log("TODO: Implement firebase JSON update.")},console.log("Constructor called.",e.match.params.bookID),o.state={downloadSuccessful:!1,currentChapter:0,bookID:o.props.match.params.bookID,bookJSON:null},o}return Object(x.a)(n,[{key:"componentDidMount",value:function(){this.downloadJSON(this.state.bookID),console.log("BOOK ID",this.state.bookID)}},{key:"render",value:function(){if(this.state.downloadSuccessful){var e=this.state.bookJSON;return console.log(e),Object(o.jsxs)("div",{children:[Object(o.jsx)(Ee.a,{height:"4px",bgcolor:"#1d85d2"}),Object(o.jsx)($,{}),Object(o.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(o.jsx)(ae,{handler:this.onSidebarClick,currentSelectedChapter:this.state.currentChapter,book:e.book}),Object(o.jsx)(Ne,{html:e.book.chapters[this.state.currentChapter].page.html,style:e.book.style,chapterNumber:this.state.currentChapter,bookID:this.state.bookID})]})]})}return Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(Te.a,{color:"#1d85d2",type:"bars"})})}}]),n}(r.Component),Fe=s.a.createContext(),Ue=function(e){var t=e.children,n=Object(r.useState)(null),s=Object(ee.a)(n,2),a=s[0],i=s[1],c=Object(r.useState)(!0),l=Object(ee.a)(c,2),d=l[0],u=l[1];return Object(r.useEffect)((function(){b.onAuthStateChanged((function(e){console.log(e),i(e),u(!1)}))}),[]),d?Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(Te.a,{color:"#1d85d2",type:"bars"})}):Object(o.jsx)(Fe.Provider,{value:{currentUser:a},children:t})},Ae=n(139),qe=n(275),_e=function(e){var t=e.component,n=Object(qe.a)(e,["component"]),s=Object(r.useContext)(Fe).currentUser;return console.log(s),Object(o.jsx)(l.b,Object(Ae.a)(Object(Ae.a)({},n),{},{render:function(e){return s?Object(o.jsx)(t,Object(Ae.a)({},e)):Object(o.jsx)(l.a,{to:"/signin/"})}}))},Be=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).import=function(){if(""!==o.state.documentLink){var e=new RegExp("/document/d/([a-zA-Z0-9-_]+)").exec(o.state.documentLink)[1];console.log(e),o.setState({bookID:e,pending:!0});var t="https://cors-anywhere.herokuapp.com/https://docs.google.com/feeds/download/documents/export/Export?id="+e+"&exportFormat=html";console.log(t),fetch(t).then((function(e){return e.text()})).then((function(e){o.conversion(e)})).catch(console.log)}},o.conversion=function(e){var t=Object(T.a)(e);console.log(t),o.upload(t)},o.upload=function(e){var t=m.child("/books/"+o.state.bookID+".json"),n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),s=Object(v.a)(o);t.put(r).then((function(e){console.log("Uploaded ",s.state.bookID,".json"),s.setState({importSuccessful:!0,pending:!1})}))},o._handleTextfieldChange=function(e){o.setState({documentLink:e.target.value})},o.state={importSuccessful:!1,bookID:"",documentLink:"",pending:!1},o}return Object(x.a)(n,[{key:"render",value:function(){var e=this;return console.log("PROPS",this.props),this.props.match&&console.log(this.props.match.params.bookID),this.state.importSuccessful?Object(o.jsx)(l.a,{to:"../read/"+this.state.bookID}):this.state.pending?Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(Te.a,{color:"#1d85d2",type:"bars"})}):Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{style:{textAlign:"center"},children:"What's your Google Doc link?"}),Object(o.jsxs)(je.a,{display:"flex",justifyContent:"center",children:[Object(o.jsx)(be.a,{id:"outlined-basic",placeholder:"https://docs.google.com/document/...",variant:"outlined",style:{width:"40rem"},onChange:this._handleTextfieldChange}),Object(o.jsx)(ne.a,{type:"submit",color:"primary",onClick:function(){e.import()},children:"IMPORT"})]})]})}}]),n}(s.a.Component),Pe=n.p+"static/media/Logo.d37141a7.svg",He=n.p+"static/media/Hero.82d2f637.svg",Qe=(n(481),n(272)),Me=n.n(Qe),Je=n(273),We=n.n(Je),Ge=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){var o;return Object(g.a)(this,n),(o=t.call(this,e)).import=function(){if(""!==o.state.documentLink){var e=new RegExp("/document/d/([a-zA-Z0-9-_]+)").exec(o.state.documentLink)[1];console.log(e),o.setState({bookID:e,pending:!0});var t="https://docs.google.com/feeds/download/documents/export/Export?id="+e+"&exportFormat=html";console.log(t),fetch(t).then((function(e){return e.text()})).then((function(e){o.conversion(e)})).catch(console.log)}},o.conversion=function(e){var t=Object(T.a)(e);console.log(t),o.upload(t)},o.upload=function(e){var t=m.child("/books/"+o.state.bookID+".json"),n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),s=Object(v.a)(o);t.put(r).then((function(e){console.log("Uploaded ",s.state.bookID,".json"),s.setState({importSuccessful:!0,pending:!1})}))},o._handleTextfieldChange=function(e){o.setState({documentLink:e.target.value})},o.state={importSuccessful:!1,bookID:"",documentLink:"",pending:!1},o}return Object(x.a)(n,[{key:"render",value:function(){var e=this;if(this.state.importSuccessful)return Object(o.jsx)(l.a,{to:"../read/"+this.state.bookID});if(this.state.pending)return Object(o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(o.jsx)(Te.a,{color:"#1d85d2",type:"bars"})});var t=Object(o.jsx)(We.a,{});return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{style:{background:"#E3F2FD",height:"600px"},children:[Object(o.jsxs)(je.a,{display:"flex",justifyContent:"center",className:"navbar",children:[Object(o.jsx)("img",{src:Pe})," "]}),Object(o.jsx)(je.a,{children:Object(o.jsxs)("h1",{id:"heading_line",children:["Publish beautiful, interactive textbooks",Object(o.jsx)("br",{}),"using only Google Docs."]})}),Object(o.jsx)(je.a,{display:"flex",justifyContent:"center",children:Object(o.jsx)(Me.a,{value:this.state.documentLink,onChange:function(t){return e.setState({documentLink:t})},placeholder:"Your Google Doc link",searchIcon:t,closeIcon:t,style:{width:"25rem"},onRequestSearch:function(){e.import()},onCancelSearch:function(){e.import()}})}),Object(o.jsxs)(je.a,{display:"flex",justifyContent:"center",className:"navbar",children:[Object(o.jsx)("img",{src:He})," "]})]})})}}]),n}(r.Component);console.log("index.js called."),i.a.render(Object(o.jsx)(s.a.StrictMode,{children:Object(o.jsx)(Ue,{children:Object(o.jsx)(c.a,{basename:"/",children:Object(o.jsxs)(l.d,{children:[Object(o.jsxs)(l.b,{path:"/signin/",children:[" ",Object(o.jsx)(O,{})," "]}),Object(o.jsxs)(l.b,{path:"/add/",exact:!0,children:[" ",Object(o.jsx)(Be,{})," "]}),Object(o.jsxs)(l.b,{path:"/home/",children:[" ",Object(o.jsx)(Ge,{})," "]}),Object(o.jsx)(_e,{path:"/read/:bookID",exact:!0,component:Le}),Object(o.jsx)(l.b,{path:"*",children:Object(o.jsx)(l.a,{to:"/home/"})})]})})})}),document.getElementById("root"))},87:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var o,r=n(75),s=n(136),a=n.n(s),i=n(274);function c(e,t,n,r){n||(n=function(e){return!0});for(var s,a,i,c,l,d,u,p,h=(r=r||{}).cheerio||null,b=[],j="data-"+N(),m="data-"+N();;){for(a=(s=o.load(e,h))(t),c=null,i=0;i<a.length&&((c=a.eq(i)).attr(m)||!n(c));i++)c.attr(m,"1"),c=null;if(!c){b.push(e);break}c.attr(j,"1");var f=s.html(),O=f.indexOf(j),g=f.lastIndexOf("<",O);if(-1===g){b.push(e);break}var x=f.substr(0,g),v="";l=o.load("<div></div>")("div").eq(0);var y=c.parents();for(i=0;i<y.length;i++){var k=y.eq(i);if(k.is("[data-cheerio-root]"))break;var I=k.clone();I.empty(),l.empty(),l.append(I);var w=l.html(),S=w.indexOf(">");x+="</"+(d=(p=I)[0].tagName||p[0].name)+">",v=w.substr(0,S+1)+v}f=s.html(),l=o.load("<div></div>")("div").eq(0),c.removeAttr(j),l.append(c),d=l.html(),c.remove(),u=v+(f=s.html()).substr(g),x=R(x),b.push(x),b.push(d),e=R(u)}return b;function R(e){return(e=o.load(e,h))("["+m+"]").removeAttr(m),e=e.html()}function N(){return Math.floor(1e9*Math.random()).toString()}}function l(e){var t=n(209);t(e,{allowedTags:t.defaults.allowedTags.concat(["img"])});console.log(e);var o=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),o=Object(r.a)(t.querySelectorAll("style")).map((function(e){return e.textContent})),s=n(410)(o[0],[/li/,/color/,/font-family/,/font-size/,/h[1-6]/,/margin/,/margin-top/,/margin-bottom/,/margin-left/,/margin-right/,/padding/,/padding-top/,/padding-bottom/,/padding-left/,/padding-right/]);return console.log(s),s}(e),s=c(e,"h1");console.log(s);for(var a=[],l=1;l<s.length-1;l+=2){var d=s[l],u=s[l+1],p={name:Object(i.a)(d).querySelector("h1").text,page:{html:d+u}};a.push(p)}return{book:{name:"DEFAULT NAME",currentSelectedChapter:0,chapters:a,style:"<style>"+o+"</style>"}}}"undefined"===typeof window?(e.exports=c,o=n(302)):(window.splitHtml=c,o={load:function(e){var t=a()("<div data-cheerio-root>"),n=a()(e);function o(e){return"<"===e[0]?a()(e):t.find(e)}return t.append(n),o.html=function(){return t.html()},o}})}).call(this,n(188)(e))}},[[509,1,2]]]);
//# sourceMappingURL=main.62ad7bfb.chunk.js.map